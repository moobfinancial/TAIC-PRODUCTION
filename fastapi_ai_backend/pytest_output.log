/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/pytest_postgresql/executor.py:29: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
[06/15/25 17:33:10] WARNING  RESEND email_utils.py:17
                             _API_K                  
                             EY                      
                             enviro                  
                             nment                   
                             variab                  
                             le not                  
                             set.                    
                             Real                    
                             email                   
                             sendin                  
                             g will                  
                             be                      
                             disabl                  
                             ed.                     
                             Emails                  
                             will                    
                             only                    
                             be                      
                             logged                  
                             .                       
============================= test session starts ==============================
platform darwin -- Python 3.11.11, pytest-7.4.4, pluggy-1.6.0 -- /Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/bin/python
cachedir: .pytest_cache
Using --randomly-seed=3104753437
metadata: {'Python': '3.11.11', 'Platform': 'macOS-13.6.9-x86_64-i386-64bit', 'Packages': {'pytest': '7.4.4', 'pluggy': '1.6.0'}, 'Plugins': {'snapshot': '0.9.0', 'xdist': '3.7.0', 'randomly': '3.16.0', 'instafail': '0.4.2', 'asyncio': '0.18.3', 'freezegun': '0.4.2', 'rerunfailures': '10.3', 'anyio': '4.9.0', 'html': '3.2.0', 'timeout': '2.4.0', 'metadata': '3.1.1', 'cov': '4.1.0', 'mock-resources': '2.12.2', 'order': '1.3.0', 'docker': '1.0.1', 'dependency': '0.5.1', 'mock': '3.14.1', 'langsmith': '0.3.45', 'postgresql': '4.1.1', 'sugar': '0.9.7', 'env': '0.8.2', 'benchmark': '4.0.0'}}
benchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)
rootdir: /Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend
configfile: pytest.ini
plugins: snapshot-0.9.0, xdist-3.7.0, randomly-3.16.0, instafail-0.4.2, asyncio-0.18.3, freezegun-0.4.2, rerunfailures-10.3, anyio-4.9.0, html-3.2.0, timeout-2.4.0, metadata-3.1.1, cov-4.1.0, mock-resources-2.12.2, order-1.3.0, docker-1.0.1, dependency-0.5.1, mock-3.14.1, langsmith-0.3.45, postgresql-4.1.1, sugar-0.9.7, env-0.8.2, benchmark-4.0.0
asyncio: mode=Mode.AUTO
collecting ... collected 48 items

tests/test_product_variants.py::test_update_product_variant [06/15/25 17:33:13] INFO     Updated      auth.py:603
                             last_login_a            
                             t for user              
                             7f859d71-134            
                             0-411d-bcc3-            
                             2677e8dc6de8            
Database pool not initialized. Attempting to initialize now...
Database connection pool initialized. DB time: 2025-06-15 21:33:12.889890+00:00

-------------------------------- live log setup --------------------------------
2025-06-15 17:33:13 [    INFO] Updated last_login_at for user 7f859d71-1340-411d-bcc3-2677e8dc6de8
                    ERROR    Unexpected   auth.py:628
                             error during            
                             login for               
                             test@example            
                             .com:                   
                             TypeError -             
                             Object of               
                             type UUID is            
                             not JSON                
                             serializable            
2025-06-15 17:33:13 [   ERROR] Unexpected error during login for test@example.com: TypeError - Object of type UUID is not JSON serializable
                    ERROR    Traceback    auth.py:630
                             (most recent            
                             call last):             
                               File                  
                             "/Users/boom            
                             mac/Download            
                             s/TAIC-Maste            
                             r/fastapi_ai            
                             _backend/app            
                             /routers/aut            
                             h.py", line             
                             617, in                 
                             login_for_ac            
                             cess_token              
                                 access_t            
                             oken =                  
                             create_acces            
                             s_token(data            
                             =token_data)            
                                                     
                                    ^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^                 
                               File                  
                             "/Users/boom            
                             mac/Download            
                             s/TAIC-Maste            
                             r/fastapi_ai            
                             _backend/app            
                             /security.py            
                             ", line 82,             
                             in                      
                             create_acces            
                             s_token                 
                                 encoded_            
                             jwt =                   
                             jwt.encode(t            
                             o_encode,               
                             SECRET_KEY,             
                             algorithm=AL            
                             GORITHM)                
                                                     
                                   ^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                               File                  
                             "/Users/boom            
                             mac/Download            
                             s/TAIC-Maste            
                             r/fastapi_ai            
                             _backend/ven            
                             v/lib/python            
                             3.11/site-pa            
                             ckages/jose/            
                             jwt.py",                
                             line 63, in             
                             encode                  
                                 return              
                             jws.sign(cla            
                             ims, key,               
                             headers=head            
                             ers,                    
                             algorithm=al            
                             gorithm)                
                                        ^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^              
                               File                  
                             "/Users/boom            
                             mac/Download            
                             s/TAIC-Maste            
                             r/fastapi_ai            
                             _backend/ven            
                             v/lib/python            
                             3.11/site-pa            
                             ckages/jose/            
                             jws.py",                
                             line 46, in             
                             sign                    
                                 encoded_            
                             payload =               
                             _encode_payl            
                             oad(payload)            
                                                     
                                       ^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^              
                               File                  
                             "/Users/boom            
                             mac/Download            
                             s/TAIC-Maste            
                             r/fastapi_ai            
                             _backend/ven            
                             v/lib/python            
                             3.11/site-pa            
                             ckages/jose/            
                             jws.py",                
                             line 150, in            
                             _encode_payl            
                             oad                     
                                 payload             
                             =                       
                             json.dumps(             
                                                     
                               ^^^^^^^^^^            
                             ^                       
                               File                  
                             "/usr/local/            
                             Cellar/pytho            
                             n@3.11/3.11.            
                             11/Framework            
                             s/Python.fra            
                             mework/Versi            
                             ons/3.11/lib            
                             /python3.11/            
                             json/__init_            
                             _.py", line             
                             238, in                 
                             dumps                   
                                 **kw).en            
                             code(obj)               
                                       ^^            
                             ^^^^^^^^^               
                               File                  
                             "/usr/local/            
                             Cellar/pytho            
                             n@3.11/3.11.            
                             11/Framework            
                             s/Python.fra            
                             mework/Versi            
                             ons/3.11/lib            
                             /python3.11/            
                             json/encoder            
                             .py", line              
                             200, in                 
                             encode                  
                                 chunks =            
                             self.iterenc            
                             ode(o,                  
                             _one_shot=Tr            
                             ue)                     
                                                     
                              ^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^             
                               File                  
                             "/usr/local/            
                             Cellar/pytho            
                             n@3.11/3.11.            
                             11/Framework            
                             s/Python.fra            
                             mework/Versi            
                             ons/3.11/lib            
                             /python3.11/            
                             json/encoder            
                             .py", line              
                             258, in                 
                             iterencode              
                                 return              
                             _iterencode(            
                             o, 0)                   
                                        ^            
                             ^^^^^^^^^^^^            
                             ^^^^                    
                               File                  
                             "/usr/local/            
                             Cellar/pytho            
                             n@3.11/3.11.            
                             11/Framework            
                             s/Python.fra            
                             mework/Versi            
                             ons/3.11/lib            
                             /python3.11/            
                             json/encoder            
                             .py", line              
                             180, in                 
                             default                 
                                 raise               
                             TypeError(f'            
                             Object of               
                             type                    
                             {o.__class__            
                             .__name__} '            
                             TypeError:              
                             Object of               
                             type UUID is            
                             not JSON                
                             serializable            
                                                     
2025-06-15 17:33:13 [   ERROR] Traceback (most recent call last):
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/app/routers/auth.py", line 617, in login_for_access_token
    access_token = create_access_token(data=token_data)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/app/security.py", line 82, in create_access_token
    encoded_jwt = jwt.encode(to_encode, SECRET_KEY, algorithm=ALGORITHM)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jwt.py", line 63, in encode
    return jws.sign(claims, key, headers=headers, algorithm=algorithm)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jws.py", line 46, in sign
    encoded_payload = _encode_payload(payload)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jws.py", line 150, in _encode_payload
    payload = json.dumps(
              ^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
          ^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           ^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type UUID is not JSON serializable

                    INFO     HTTP     _client.py:1740
                             Request:                
                             POST                    
                             http://t                
                             est/api/                
                             auth/log                
                             in                      
                             "HTTP/1.                
                             1 500                   
                             Internal                
                             Server                  
                             Error"                  
2025-06-15 17:33:13 [    INFO] HTTP Request: POST http://test/api/auth/login "HTTP/1.1 500 Internal Server Error"
ERROR
tests/test_product_variants.py::test_get_product_variant [06/15/25 17:33:14] INFO     HTTP     _client.py:1740
                             Request:                
                             GET                     
                             http://t                
                             est/api/                
                             v1/produ                
                             cts/1/va                
                             riants                  
                             "HTTP/1.                
                             1 200                   
                             OK"                     
DB Context [Test: test_get_product_variant]: Acquiring connection from specific pool <asyncpg.pool.Pool object at 0x117602dc0> (ID: 4687146432). Pool state: Size=1, Free=5
DB Context [Test: test_get_product_variant]: Acquired connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x1176511c0> 0x117677f10> (ID: 4687626000) from specific pool <asyncpg.pool.Pool object at 0x117602dc0> (ID: 4687146432). Pool free: 4

-------------------------------- live log call ---------------------------------
2025-06-15 17:33:14 [    INFO] HTTP Request: GET http://test/api/v1/products/1/variants "HTTP/1.1 200 OK"
                    INFO     HTTP     _client.py:1740
                             Request:                
                             GET                     
                             http://t                
                             est/api/                
                             v1/varia                
                             nts/1                   
                             "HTTP/1.                
                             1 200                   
                             OK"                     
2025-06-15 17:33:14 [    INFO] HTTP Request: GET http://test/api/v1/variants/1 "HTTP/1.1 200 OK"
PASSEDDB Context [Test: test_get_product_variant]: Returned from yield for connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x1176511c0> 0x117677f10> (ID: 4687626000).
DB Context [Test: test_get_product_variant]: Releasing connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x1176511c0> 0x117677f10> (ID: 4687626000) to specific pool <asyncpg.pool.Pool object at 0x117602dc0> (ID: 4687146432). Pool free before release: 4
DB Context [Test: test_get_product_variant]: Released connection <PoolConnectionProxy [released] 0x117677f10> (ID: 4687626000) to specific pool <asyncpg.pool.Pool object at 0x117602dc0> (ID: 4687146432). Pool free after release: 5

tests/test_product_variants.py::test_delete_product_variant                     INFO     Updated      auth.py:603
                             last_login_a            
                             t for user              
                             7f859d71-134            
                             0-411d-bcc3-            
                             2677e8dc6de8            

-------------------------------- live log setup --------------------------------
2025-06-15 17:33:14 [    INFO] Updated last_login_at for user 7f859d71-1340-411d-bcc3-2677e8dc6de8
                    ERROR    Unexpected   auth.py:628
                             error during            
                             login for               
                             test@example            
                             .com:                   
                             TypeError -             
                             Object of               
                             type UUID is            
                             not JSON                
                             serializable            
2025-06-15 17:33:14 [   ERROR] Unexpected error during login for test@example.com: TypeError - Object of type UUID is not JSON serializable
                    ERROR    Traceback    auth.py:630
                             (most recent            
                             call last):             
                               File                  
                             "/Users/boom            
                             mac/Download            
                             s/TAIC-Maste            
                             r/fastapi_ai            
                             _backend/app            
                             /routers/aut            
                             h.py", line             
                             617, in                 
                             login_for_ac            
                             cess_token              
                                 access_t            
                             oken =                  
                             create_acces            
                             s_token(data            
                             =token_data)            
                                                     
                                    ^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^                 
                               File                  
                             "/Users/boom            
                             mac/Download            
                             s/TAIC-Maste            
                             r/fastapi_ai            
                             _backend/app            
                             /security.py            
                             ", line 82,             
                             in                      
                             create_acces            
                             s_token                 
                                 encoded_            
                             jwt =                   
                             jwt.encode(t            
                             o_encode,               
                             SECRET_KEY,             
                             algorithm=AL            
                             GORITHM)                
                                                     
                                   ^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                               File                  
                             "/Users/boom            
                             mac/Download            
                             s/TAIC-Maste            
                             r/fastapi_ai            
                             _backend/ven            
                             v/lib/python            
                             3.11/site-pa            
                             ckages/jose/            
                             jwt.py",                
                             line 63, in             
                             encode                  
                                 return              
                             jws.sign(cla            
                             ims, key,               
                             headers=head            
                             ers,                    
                             algorithm=al            
                             gorithm)                
                                        ^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^              
                               File                  
                             "/Users/boom            
                             mac/Download            
                             s/TAIC-Maste            
                             r/fastapi_ai            
                             _backend/ven            
                             v/lib/python            
                             3.11/site-pa            
                             ckages/jose/            
                             jws.py",                
                             line 46, in             
                             sign                    
                                 encoded_            
                             payload =               
                             _encode_payl            
                             oad(payload)            
                                                     
                                       ^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^              
                               File                  
                             "/Users/boom            
                             mac/Download            
                             s/TAIC-Maste            
                             r/fastapi_ai            
                             _backend/ven            
                             v/lib/python            
                             3.11/site-pa            
                             ckages/jose/            
                             jws.py",                
                             line 150, in            
                             _encode_payl            
                             oad                     
                                 payload             
                             =                       
                             json.dumps(             
                                                     
                               ^^^^^^^^^^            
                             ^                       
                               File                  
                             "/usr/local/            
                             Cellar/pytho            
                             n@3.11/3.11.            
                             11/Framework            
                             s/Python.fra            
                             mework/Versi            
                             ons/3.11/lib            
                             /python3.11/            
                             json/__init_            
                             _.py", line             
                             238, in                 
                             dumps                   
                                 **kw).en            
                             code(obj)               
                                       ^^            
                             ^^^^^^^^^               
                               File                  
                             "/usr/local/            
                             Cellar/pytho            
                             n@3.11/3.11.            
                             11/Framework            
                             s/Python.fra            
                             mework/Versi            
                             ons/3.11/lib            
                             /python3.11/            
                             json/encoder            
                             .py", line              
                             200, in                 
                             encode                  
                                 chunks =            
                             self.iterenc            
                             ode(o,                  
                             _one_shot=Tr            
                             ue)                     
                                                     
                              ^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^             
                               File                  
                             "/usr/local/            
                             Cellar/pytho            
                             n@3.11/3.11.            
                             11/Framework            
                             s/Python.fra            
                             mework/Versi            
                             ons/3.11/lib            
                             /python3.11/            
                             json/encoder            
                             .py", line              
                             258, in                 
                             iterencode              
                                 return              
                             _iterencode(            
                             o, 0)                   
                                        ^            
                             ^^^^^^^^^^^^            
                             ^^^^                    
                               File                  
                             "/usr/local/            
                             Cellar/pytho            
                             n@3.11/3.11.            
                             11/Framework            
                             s/Python.fra            
                             mework/Versi            
                             ons/3.11/lib            
                             /python3.11/            
                             json/encoder            
                             .py", line              
                             180, in                 
                             default                 
                                 raise               
                             TypeError(f'            
                             Object of               
                             type                    
                             {o.__class__            
                             .__name__} '            
                             TypeError:              
                             Object of               
                             type UUID is            
                             not JSON                
                             serializable            
                                                     
2025-06-15 17:33:14 [   ERROR] Traceback (most recent call last):
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/app/routers/auth.py", line 617, in login_for_access_token
    access_token = create_access_token(data=token_data)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/app/security.py", line 82, in create_access_token
    encoded_jwt = jwt.encode(to_encode, SECRET_KEY, algorithm=ALGORITHM)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jwt.py", line 63, in encode
    return jws.sign(claims, key, headers=headers, algorithm=algorithm)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jws.py", line 46, in sign
    encoded_payload = _encode_payload(payload)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jws.py", line 150, in _encode_payload
    payload = json.dumps(
              ^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
          ^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           ^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type UUID is not JSON serializable

                    INFO     HTTP     _client.py:1740
                             Request:                
                             POST                    
                             http://t                
                             est/api/                
                             auth/log                
                             in                      
                             "HTTP/1.                
                             1 500                   
                             Internal                
                             Server                  
                             Error"                  
2025-06-15 17:33:14 [    INFO] HTTP Request: POST http://test/api/auth/login "HTTP/1.1 500 Internal Server Error"
ERROR
tests/test_product_variants.py::test_list_variants_for_product                     INFO     HTTP     _client.py:1740
                             Request:                
                             GET                     
                             http://t                
                             est/api/                
                             v1/produ                
                             cts/1/va                
                             riants                  
                             "HTTP/1.                
                             1 200                   
                             OK"                     
DB Context [Test: test_list_variants_for_product]: Acquiring connection from specific pool <asyncpg.pool.Pool object at 0x117602dc0> (ID: 4687146432). Pool state: Size=1, Free=5
DB Context [Test: test_list_variants_for_product]: Acquired connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x1176511c0> 0x1198d9c30> (ID: 4723678256) from specific pool <asyncpg.pool.Pool object at 0x117602dc0> (ID: 4687146432). Pool free: 4

-------------------------------- live log call ---------------------------------
2025-06-15 17:33:14 [    INFO] HTTP Request: GET http://test/api/v1/products/1/variants "HTTP/1.1 200 OK"
PASSEDDB Context [Test: test_list_variants_for_product]: Returned from yield for connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x1176511c0> 0x1198d9c30> (ID: 4723678256).
DB Context [Test: test_list_variants_for_product]: Releasing connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x1176511c0> 0x1198d9c30> (ID: 4723678256) to specific pool <asyncpg.pool.Pool object at 0x117602dc0> (ID: 4687146432). Pool free before release: 4
DB Context [Test: test_list_variants_for_product]: Released connection <PoolConnectionProxy [released] 0x1198d9c30> (ID: 4723678256) to specific pool <asyncpg.pool.Pool object at 0x117602dc0> (ID: 4687146432). Pool free after release: 5

tests/test_product_variants.py::test_create_product_variant                     INFO     Updated      auth.py:603
                             last_login_a            
                             t for user              
                             7f859d71-134            
                             0-411d-bcc3-            
                             2677e8dc6de8            

-------------------------------- live log setup --------------------------------
2025-06-15 17:33:14 [    INFO] Updated last_login_at for user 7f859d71-1340-411d-bcc3-2677e8dc6de8
                    ERROR    Unexpected   auth.py:628
                             error during            
                             login for               
                             test@example            
                             .com:                   
                             TypeError -             
                             Object of               
                             type UUID is            
                             not JSON                
                             serializable            
2025-06-15 17:33:14 [   ERROR] Unexpected error during login for test@example.com: TypeError - Object of type UUID is not JSON serializable
                    ERROR    Traceback    auth.py:630
                             (most recent            
                             call last):             
                               File                  
                             "/Users/boom            
                             mac/Download            
                             s/TAIC-Maste            
                             r/fastapi_ai            
                             _backend/app            
                             /routers/aut            
                             h.py", line             
                             617, in                 
                             login_for_ac            
                             cess_token              
                                 access_t            
                             oken =                  
                             create_acces            
                             s_token(data            
                             =token_data)            
                                                     
                                    ^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^                 
                               File                  
                             "/Users/boom            
                             mac/Download            
                             s/TAIC-Maste            
                             r/fastapi_ai            
                             _backend/app            
                             /security.py            
                             ", line 82,             
                             in                      
                             create_acces            
                             s_token                 
                                 encoded_            
                             jwt =                   
                             jwt.encode(t            
                             o_encode,               
                             SECRET_KEY,             
                             algorithm=AL            
                             GORITHM)                
                                                     
                                   ^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                               File                  
                             "/Users/boom            
                             mac/Download            
                             s/TAIC-Maste            
                             r/fastapi_ai            
                             _backend/ven            
                             v/lib/python            
                             3.11/site-pa            
                             ckages/jose/            
                             jwt.py",                
                             line 63, in             
                             encode                  
                                 return              
                             jws.sign(cla            
                             ims, key,               
                             headers=head            
                             ers,                    
                             algorithm=al            
                             gorithm)                
                                        ^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^              
                               File                  
                             "/Users/boom            
                             mac/Download            
                             s/TAIC-Maste            
                             r/fastapi_ai            
                             _backend/ven            
                             v/lib/python            
                             3.11/site-pa            
                             ckages/jose/            
                             jws.py",                
                             line 46, in             
                             sign                    
                                 encoded_            
                             payload =               
                             _encode_payl            
                             oad(payload)            
                                                     
                                       ^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^              
                               File                  
                             "/Users/boom            
                             mac/Download            
                             s/TAIC-Maste            
                             r/fastapi_ai            
                             _backend/ven            
                             v/lib/python            
                             3.11/site-pa            
                             ckages/jose/            
                             jws.py",                
                             line 150, in            
                             _encode_payl            
                             oad                     
                                 payload             
                             =                       
                             json.dumps(             
                                                     
                               ^^^^^^^^^^            
                             ^                       
                               File                  
                             "/usr/local/            
                             Cellar/pytho            
                             n@3.11/3.11.            
                             11/Framework            
                             s/Python.fra            
                             mework/Versi            
                             ons/3.11/lib            
                             /python3.11/            
                             json/__init_            
                             _.py", line             
                             238, in                 
                             dumps                   
                                 **kw).en            
                             code(obj)               
                                       ^^            
                             ^^^^^^^^^               
                               File                  
                             "/usr/local/            
                             Cellar/pytho            
                             n@3.11/3.11.            
                             11/Framework            
                             s/Python.fra            
                             mework/Versi            
                             ons/3.11/lib            
                             /python3.11/            
                             json/encoder            
                             .py", line              
                             200, in                 
                             encode                  
                                 chunks =            
                             self.iterenc            
                             ode(o,                  
                             _one_shot=Tr            
                             ue)                     
                                                     
                              ^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^             
                               File                  
                             "/usr/local/            
                             Cellar/pytho            
                             n@3.11/3.11.            
                             11/Framework            
                             s/Python.fra            
                             mework/Versi            
                             ons/3.11/lib            
                             /python3.11/            
                             json/encoder            
                             .py", line              
                             258, in                 
                             iterencode              
                                 return              
                             _iterencode(            
                             o, 0)                   
                                        ^            
                             ^^^^^^^^^^^^            
                             ^^^^                    
                               File                  
                             "/usr/local/            
                             Cellar/pytho            
                             n@3.11/3.11.            
                             11/Framework            
                             s/Python.fra            
                             mework/Versi            
                             ons/3.11/lib            
                             /python3.11/            
                             json/encoder            
                             .py", line              
                             180, in                 
                             default                 
                                 raise               
                             TypeError(f'            
                             Object of               
                             type                    
                             {o.__class__            
                             .__name__} '            
                             TypeError:              
                             Object of               
                             type UUID is            
                             not JSON                
                             serializable            
                                                     
2025-06-15 17:33:14 [   ERROR] Traceback (most recent call last):
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/app/routers/auth.py", line 617, in login_for_access_token
    access_token = create_access_token(data=token_data)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/app/security.py", line 82, in create_access_token
    encoded_jwt = jwt.encode(to_encode, SECRET_KEY, algorithm=ALGORITHM)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jwt.py", line 63, in encode
    return jws.sign(claims, key, headers=headers, algorithm=algorithm)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jws.py", line 46, in sign
    encoded_payload = _encode_payload(payload)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jws.py", line 150, in _encode_payload
    payload = json.dumps(
              ^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
          ^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           ^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type UUID is not JSON serializable

                    INFO     HTTP     _client.py:1740
                             Request:                
                             POST                    
                             http://t                
                             est/api/                
                             auth/log                
                             in                      
                             "HTTP/1.                
                             1 500                   
                             Internal                
                             Server                  
                             Error"                  
2025-06-15 17:33:14 [    INFO] HTTP Request: POST http://test/api/auth/login "HTTP/1.1 500 Internal Server Error"
ERROR
pytest_conftest: test_db fixture - Post-yield cleanup starting (TRUNCATE tables)...
pytest_conftest: test_db fixture - Acquired connection for TRUNCATE.
pytest_conftest: test_db fixture - TRUNCATE successful.
pytest_conftest: test_db fixture - Connection for TRUNCATE (if acquired) released by 'async with'.
pytest_conftest: test_db fixture - Post-yield cleanup finished.

pytest_conftest: test_db fixture - Starting 'finally' block for teardown...
pytest_conftest: test_db fixture - Restoring global POOL...
pytest_conftest: test_db fixture - Global POOL restored.
pytest_conftest: test_db fixture - Restoring app.state.pool...
pytest_conftest: test_db fixture - app.state.pool restored.
pytest_conftest: test_db fixture - Attempting to close fixture_pool...
pytest_conftest: test_db fixture - fixture_pool closed successfully.
pytest_conftest: test_db fixture - 'finally' block teardown complete.

tests/test_simple.py::test_async_passes PASSED
tests/test_simple.py::test_always_passes PASSED
tests/test_products.py::test_search_products DB Context [Test: test_search_products]: Acquiring connection from specific pool <asyncpg.pool.Pool object at 0x1176028e0> (ID: 4687145184). Pool state: Size=1, Free=5
DB Context [Test: test_search_products]: Acquired connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x117611fc0> 0x1198d8a30> (ID: 4723673648) from specific pool <asyncpg.pool.Pool object at 0x1176028e0> (ID: 4687145184). Pool free: 4
FAILEDDB Context [Test: test_search_products]: Returned from yield for connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x117611fc0> 0x1198d8a30> (ID: 4723673648).
DB Context [Test: test_search_products]: Releasing connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x117611fc0> 0x1198d8a30> (ID: 4723673648) to specific pool <asyncpg.pool.Pool object at 0x1176028e0> (ID: 4687145184). Pool free before release: 4
DB Context [Test: test_search_products]: Released connection <PoolConnectionProxy [released] 0x1198d8a30> (ID: 4723673648) to specific pool <asyncpg.pool.Pool object at 0x1176028e0> (ID: 4687145184). Pool free after release: 5

tests/test_products.py::test_create_product [06/15/25 17:33:15] INFO     Updated      auth.py:603
                             last_login_a            
                             t for user              
                             afa53d60-96f            
                             9-47c3-8b40-            
                             1302612be145            

-------------------------------- live log setup --------------------------------
2025-06-15 17:33:15 [    INFO] Updated last_login_at for user afa53d60-96f9-47c3-8b40-1302612be145
                    ERROR    Unexpected   auth.py:628
                             error during            
                             login for               
                             test@example            
                             .com:                   
                             TypeError -             
                             Object of               
                             type UUID is            
                             not JSON                
                             serializable            
2025-06-15 17:33:15 [   ERROR] Unexpected error during login for test@example.com: TypeError - Object of type UUID is not JSON serializable
                    ERROR    Traceback    auth.py:630
                             (most recent            
                             call last):             
                               File                  
                             "/Users/boom            
                             mac/Download            
                             s/TAIC-Maste            
                             r/fastapi_ai            
                             _backend/app            
                             /routers/aut            
                             h.py", line             
                             617, in                 
                             login_for_ac            
                             cess_token              
                                 access_t            
                             oken =                  
                             create_acces            
                             s_token(data            
                             =token_data)            
                                                     
                                    ^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^                 
                               File                  
                             "/Users/boom            
                             mac/Download            
                             s/TAIC-Maste            
                             r/fastapi_ai            
                             _backend/app            
                             /security.py            
                             ", line 82,             
                             in                      
                             create_acces            
                             s_token                 
                                 encoded_            
                             jwt =                   
                             jwt.encode(t            
                             o_encode,               
                             SECRET_KEY,             
                             algorithm=AL            
                             GORITHM)                
                                                     
                                   ^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                               File                  
                             "/Users/boom            
                             mac/Download            
                             s/TAIC-Maste            
                             r/fastapi_ai            
                             _backend/ven            
                             v/lib/python            
                             3.11/site-pa            
                             ckages/jose/            
                             jwt.py",                
                             line 63, in             
                             encode                  
                                 return              
                             jws.sign(cla            
                             ims, key,               
                             headers=head            
                             ers,                    
                             algorithm=al            
                             gorithm)                
                                        ^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^              
                               File                  
                             "/Users/boom            
                             mac/Download            
                             s/TAIC-Maste            
                             r/fastapi_ai            
                             _backend/ven            
                             v/lib/python            
                             3.11/site-pa            
                             ckages/jose/            
                             jws.py",                
                             line 46, in             
                             sign                    
                                 encoded_            
                             payload =               
                             _encode_payl            
                             oad(payload)            
                                                     
                                       ^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^              
                               File                  
                             "/Users/boom            
                             mac/Download            
                             s/TAIC-Maste            
                             r/fastapi_ai            
                             _backend/ven            
                             v/lib/python            
                             3.11/site-pa            
                             ckages/jose/            
                             jws.py",                
                             line 150, in            
                             _encode_payl            
                             oad                     
                                 payload             
                             =                       
                             json.dumps(             
                                                     
                               ^^^^^^^^^^            
                             ^                       
                               File                  
                             "/usr/local/            
                             Cellar/pytho            
                             n@3.11/3.11.            
                             11/Framework            
                             s/Python.fra            
                             mework/Versi            
                             ons/3.11/lib            
                             /python3.11/            
                             json/__init_            
                             _.py", line             
                             238, in                 
                             dumps                   
                                 **kw).en            
                             code(obj)               
                                       ^^            
                             ^^^^^^^^^               
                               File                  
                             "/usr/local/            
                             Cellar/pytho            
                             n@3.11/3.11.            
                             11/Framework            
                             s/Python.fra            
                             mework/Versi            
                             ons/3.11/lib            
                             /python3.11/            
                             json/encoder            
                             .py", line              
                             200, in                 
                             encode                  
                                 chunks =            
                             self.iterenc            
                             ode(o,                  
                             _one_shot=Tr            
                             ue)                     
                                                     
                              ^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^             
                               File                  
                             "/usr/local/            
                             Cellar/pytho            
                             n@3.11/3.11.            
                             11/Framework            
                             s/Python.fra            
                             mework/Versi            
                             ons/3.11/lib            
                             /python3.11/            
                             json/encoder            
                             .py", line              
                             258, in                 
                             iterencode              
                                 return              
                             _iterencode(            
                             o, 0)                   
                                        ^            
                             ^^^^^^^^^^^^            
                             ^^^^                    
                               File                  
                             "/usr/local/            
                             Cellar/pytho            
                             n@3.11/3.11.            
                             11/Framework            
                             s/Python.fra            
                             mework/Versi            
                             ons/3.11/lib            
                             /python3.11/            
                             json/encoder            
                             .py", line              
                             180, in                 
                             default                 
                                 raise               
                             TypeError(f'            
                             Object of               
                             type                    
                             {o.__class__            
                             .__name__} '            
                             TypeError:              
                             Object of               
                             type UUID is            
                             not JSON                
                             serializable            
                                                     
2025-06-15 17:33:15 [   ERROR] Traceback (most recent call last):
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/app/routers/auth.py", line 617, in login_for_access_token
    access_token = create_access_token(data=token_data)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/app/security.py", line 82, in create_access_token
    encoded_jwt = jwt.encode(to_encode, SECRET_KEY, algorithm=ALGORITHM)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jwt.py", line 63, in encode
    return jws.sign(claims, key, headers=headers, algorithm=algorithm)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jws.py", line 46, in sign
    encoded_payload = _encode_payload(payload)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jws.py", line 150, in _encode_payload
    payload = json.dumps(
              ^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
          ^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           ^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type UUID is not JSON serializable

                    INFO     HTTP     _client.py:1740
                             Request:                
                             POST                    
                             http://t                
                             est/api/                
                             auth/log                
                             in                      
                             "HTTP/1.                
                             1 500                   
                             Internal                
                             Server                  
                             Error"                  
2025-06-15 17:33:15 [    INFO] HTTP Request: POST http://test/api/auth/login "HTTP/1.1 500 Internal Server Error"
ERROR
tests/test_products.py::test_get_product_detail FAILED
tests/test_products.py::test_update_product [06/15/25 17:33:16] INFO     Updated      auth.py:603
                             last_login_a            
                             t for user              
                             afa53d60-96f            
                             9-47c3-8b40-            
                             1302612be145            

-------------------------------- live log setup --------------------------------
2025-06-15 17:33:16 [    INFO] Updated last_login_at for user afa53d60-96f9-47c3-8b40-1302612be145
                    ERROR    Unexpected   auth.py:628
                             error during            
                             login for               
                             test@example            
                             .com:                   
                             TypeError -             
                             Object of               
                             type UUID is            
                             not JSON                
                             serializable            
2025-06-15 17:33:16 [   ERROR] Unexpected error during login for test@example.com: TypeError - Object of type UUID is not JSON serializable
                    ERROR    Traceback    auth.py:630
                             (most recent            
                             call last):             
                               File                  
                             "/Users/boom            
                             mac/Download            
                             s/TAIC-Maste            
                             r/fastapi_ai            
                             _backend/app            
                             /routers/aut            
                             h.py", line             
                             617, in                 
                             login_for_ac            
                             cess_token              
                                 access_t            
                             oken =                  
                             create_acces            
                             s_token(data            
                             =token_data)            
                                                     
                                    ^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^                 
                               File                  
                             "/Users/boom            
                             mac/Download            
                             s/TAIC-Maste            
                             r/fastapi_ai            
                             _backend/app            
                             /security.py            
                             ", line 82,             
                             in                      
                             create_acces            
                             s_token                 
                                 encoded_            
                             jwt =                   
                             jwt.encode(t            
                             o_encode,               
                             SECRET_KEY,             
                             algorithm=AL            
                             GORITHM)                
                                                     
                                   ^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                               File                  
                             "/Users/boom            
                             mac/Download            
                             s/TAIC-Maste            
                             r/fastapi_ai            
                             _backend/ven            
                             v/lib/python            
                             3.11/site-pa            
                             ckages/jose/            
                             jwt.py",                
                             line 63, in             
                             encode                  
                                 return              
                             jws.sign(cla            
                             ims, key,               
                             headers=head            
                             ers,                    
                             algorithm=al            
                             gorithm)                
                                        ^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^              
                               File                  
                             "/Users/boom            
                             mac/Download            
                             s/TAIC-Maste            
                             r/fastapi_ai            
                             _backend/ven            
                             v/lib/python            
                             3.11/site-pa            
                             ckages/jose/            
                             jws.py",                
                             line 46, in             
                             sign                    
                                 encoded_            
                             payload =               
                             _encode_payl            
                             oad(payload)            
                                                     
                                       ^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^              
                               File                  
                             "/Users/boom            
                             mac/Download            
                             s/TAIC-Maste            
                             r/fastapi_ai            
                             _backend/ven            
                             v/lib/python            
                             3.11/site-pa            
                             ckages/jose/            
                             jws.py",                
                             line 150, in            
                             _encode_payl            
                             oad                     
                                 payload             
                             =                       
                             json.dumps(             
                                                     
                               ^^^^^^^^^^            
                             ^                       
                               File                  
                             "/usr/local/            
                             Cellar/pytho            
                             n@3.11/3.11.            
                             11/Framework            
                             s/Python.fra            
                             mework/Versi            
                             ons/3.11/lib            
                             /python3.11/            
                             json/__init_            
                             _.py", line             
                             238, in                 
                             dumps                   
                                 **kw).en            
                             code(obj)               
                                       ^^            
                             ^^^^^^^^^               
                               File                  
                             "/usr/local/            
                             Cellar/pytho            
                             n@3.11/3.11.            
                             11/Framework            
                             s/Python.fra            
                             mework/Versi            
                             ons/3.11/lib            
                             /python3.11/            
                             json/encoder            
                             .py", line              
                             200, in                 
                             encode                  
                                 chunks =            
                             self.iterenc            
                             ode(o,                  
                             _one_shot=Tr            
                             ue)                     
                                                     
                              ^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^             
                               File                  
                             "/usr/local/            
                             Cellar/pytho            
                             n@3.11/3.11.            
                             11/Framework            
                             s/Python.fra            
                             mework/Versi            
                             ons/3.11/lib            
                             /python3.11/            
                             json/encoder            
                             .py", line              
                             258, in                 
                             iterencode              
                                 return              
                             _iterencode(            
                             o, 0)                   
                                        ^            
                             ^^^^^^^^^^^^            
                             ^^^^                    
                               File                  
                             "/usr/local/            
                             Cellar/pytho            
                             n@3.11/3.11.            
                             11/Framework            
                             s/Python.fra            
                             mework/Versi            
                             ons/3.11/lib            
                             /python3.11/            
                             json/encoder            
                             .py", line              
                             180, in                 
                             default                 
                                 raise               
                             TypeError(f'            
                             Object of               
                             type                    
                             {o.__class__            
                             .__name__} '            
                             TypeError:              
                             Object of               
                             type UUID is            
                             not JSON                
                             serializable            
                                                     
2025-06-15 17:33:16 [   ERROR] Traceback (most recent call last):
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/app/routers/auth.py", line 617, in login_for_access_token
    access_token = create_access_token(data=token_data)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/app/security.py", line 82, in create_access_token
    encoded_jwt = jwt.encode(to_encode, SECRET_KEY, algorithm=ALGORITHM)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jwt.py", line 63, in encode
    return jws.sign(claims, key, headers=headers, algorithm=algorithm)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jws.py", line 46, in sign
    encoded_payload = _encode_payload(payload)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jws.py", line 150, in _encode_payload
    payload = json.dumps(
              ^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
          ^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           ^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type UUID is not JSON serializable

                    INFO     HTTP     _client.py:1740
                             Request:                
                             POST                    
                             http://t                
                             est/api/                
                             auth/log                
                             in                      
                             "HTTP/1.                
                             1 500                   
                             Internal                
                             Server                  
                             Error"                  
2025-06-15 17:33:16 [    INFO] HTTP Request: POST http://test/api/auth/login "HTTP/1.1 500 Internal Server Error"
ERROR
tests/test_products.py::test_delete_product                     INFO     Updated      auth.py:603
                             last_login_a            
                             t for user              
                             afa53d60-96f            
                             9-47c3-8b40-            
                             1302612be145            

-------------------------------- live log setup --------------------------------
2025-06-15 17:33:16 [    INFO] Updated last_login_at for user afa53d60-96f9-47c3-8b40-1302612be145
                    ERROR    Unexpected   auth.py:628
                             error during            
                             login for               
                             test@example            
                             .com:                   
                             TypeError -             
                             Object of               
                             type UUID is            
                             not JSON                
                             serializable            
2025-06-15 17:33:16 [   ERROR] Unexpected error during login for test@example.com: TypeError - Object of type UUID is not JSON serializable
                    ERROR    Traceback    auth.py:630
                             (most recent            
                             call last):             
                               File                  
                             "/Users/boom            
                             mac/Download            
                             s/TAIC-Maste            
                             r/fastapi_ai            
                             _backend/app            
                             /routers/aut            
                             h.py", line             
                             617, in                 
                             login_for_ac            
                             cess_token              
                                 access_t            
                             oken =                  
                             create_acces            
                             s_token(data            
                             =token_data)            
                                                     
                                    ^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^                 
                               File                  
                             "/Users/boom            
                             mac/Download            
                             s/TAIC-Maste            
                             r/fastapi_ai            
                             _backend/app            
                             /security.py            
                             ", line 82,             
                             in                      
                             create_acces            
                             s_token                 
                                 encoded_            
                             jwt =                   
                             jwt.encode(t            
                             o_encode,               
                             SECRET_KEY,             
                             algorithm=AL            
                             GORITHM)                
                                                     
                                   ^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                               File                  
                             "/Users/boom            
                             mac/Download            
                             s/TAIC-Maste            
                             r/fastapi_ai            
                             _backend/ven            
                             v/lib/python            
                             3.11/site-pa            
                             ckages/jose/            
                             jwt.py",                
                             line 63, in             
                             encode                  
                                 return              
                             jws.sign(cla            
                             ims, key,               
                             headers=head            
                             ers,                    
                             algorithm=al            
                             gorithm)                
                                        ^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^              
                               File                  
                             "/Users/boom            
                             mac/Download            
                             s/TAIC-Maste            
                             r/fastapi_ai            
                             _backend/ven            
                             v/lib/python            
                             3.11/site-pa            
                             ckages/jose/            
                             jws.py",                
                             line 46, in             
                             sign                    
                                 encoded_            
                             payload =               
                             _encode_payl            
                             oad(payload)            
                                                     
                                       ^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^              
                               File                  
                             "/Users/boom            
                             mac/Download            
                             s/TAIC-Maste            
                             r/fastapi_ai            
                             _backend/ven            
                             v/lib/python            
                             3.11/site-pa            
                             ckages/jose/            
                             jws.py",                
                             line 150, in            
                             _encode_payl            
                             oad                     
                                 payload             
                             =                       
                             json.dumps(             
                                                     
                               ^^^^^^^^^^            
                             ^                       
                               File                  
                             "/usr/local/            
                             Cellar/pytho            
                             n@3.11/3.11.            
                             11/Framework            
                             s/Python.fra            
                             mework/Versi            
                             ons/3.11/lib            
                             /python3.11/            
                             json/__init_            
                             _.py", line             
                             238, in                 
                             dumps                   
                                 **kw).en            
                             code(obj)               
                                       ^^            
                             ^^^^^^^^^               
                               File                  
                             "/usr/local/            
                             Cellar/pytho            
                             n@3.11/3.11.            
                             11/Framework            
                             s/Python.fra            
                             mework/Versi            
                             ons/3.11/lib            
                             /python3.11/            
                             json/encoder            
                             .py", line              
                             200, in                 
                             encode                  
                                 chunks =            
                             self.iterenc            
                             ode(o,                  
                             _one_shot=Tr            
                             ue)                     
                                                     
                              ^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^             
                               File                  
                             "/usr/local/            
                             Cellar/pytho            
                             n@3.11/3.11.            
                             11/Framework            
                             s/Python.fra            
                             mework/Versi            
                             ons/3.11/lib            
                             /python3.11/            
                             json/encoder            
                             .py", line              
                             258, in                 
                             iterencode              
                                 return              
                             _iterencode(            
                             o, 0)                   
                                        ^            
                             ^^^^^^^^^^^^            
                             ^^^^                    
                               File                  
                             "/usr/local/            
                             Cellar/pytho            
                             n@3.11/3.11.            
                             11/Framework            
                             s/Python.fra            
                             mework/Versi            
                             ons/3.11/lib            
                             /python3.11/            
                             json/encoder            
                             .py", line              
                             180, in                 
                             default                 
                                 raise               
                             TypeError(f'            
                             Object of               
                             type                    
                             {o.__class__            
                             .__name__} '            
                             TypeError:              
                             Object of               
                             type UUID is            
                             not JSON                
                             serializable            
                                                     
2025-06-15 17:33:16 [   ERROR] Traceback (most recent call last):
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/app/routers/auth.py", line 617, in login_for_access_token
    access_token = create_access_token(data=token_data)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/app/security.py", line 82, in create_access_token
    encoded_jwt = jwt.encode(to_encode, SECRET_KEY, algorithm=ALGORITHM)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jwt.py", line 63, in encode
    return jws.sign(claims, key, headers=headers, algorithm=algorithm)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jws.py", line 46, in sign
    encoded_payload = _encode_payload(payload)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jws.py", line 150, in _encode_payload
    payload = json.dumps(
              ^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
          ^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           ^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type UUID is not JSON serializable

                    INFO     HTTP     _client.py:1740
                             Request:                
                             POST                    
                             http://t                
                             est/api/                
                             auth/log                
                             in                      
                             "HTTP/1.                
                             1 500                   
                             Internal                
                             Server                  
                             Error"                  
2025-06-15 17:33:16 [    INFO] HTTP Request: POST http://test/api/auth/login "HTTP/1.1 500 Internal Server Error"
ERROR
pytest_conftest: test_db fixture - Post-yield cleanup starting (TRUNCATE tables)...
pytest_conftest: test_db fixture - Acquired connection for TRUNCATE.
pytest_conftest: test_db fixture - TRUNCATE successful.
pytest_conftest: test_db fixture - Connection for TRUNCATE (if acquired) released by 'async with'.
pytest_conftest: test_db fixture - Post-yield cleanup finished.

pytest_conftest: test_db fixture - Starting 'finally' block for teardown...
pytest_conftest: test_db fixture - Restoring global POOL...
pytest_conftest: test_db fixture - Global POOL restored.
pytest_conftest: test_db fixture - Restoring app.state.pool...
pytest_conftest: test_db fixture - app.state.pool restored.
pytest_conftest: test_db fixture - Attempting to close fixture_pool...
pytest_conftest: test_db fixture - fixture_pool closed successfully.
pytest_conftest: test_db fixture - 'finally' block teardown complete.

tests/test_auth.py::test_register_user_email_already_exists [06/15/25 17:33:17] INFO     HTTP     _client.py:1740
                             Request:                
                             POST                    
                             http://t                
                             est/api/                
                             auth/reg                
                             ister                   
                             "HTTP/1.                
                             1 409                   
                             Conflict                
                             "                       
DB Context [Test: test_register_user_email_already_exists]: Acquiring connection from specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool state: Size=1, Free=5
DB Context [Test: test_register_user_email_already_exists]: Acquired connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x1198fbb20> (ID: 4723817248) from specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free: 4

-------------------------------- live log call ---------------------------------
2025-06-15 17:33:17 [    INFO] HTTP Request: POST http://test/api/auth/register "HTTP/1.1 409 Conflict"
PASSEDDB Context [Test: test_register_user_email_already_exists]: Returned from yield for connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x1198fbb20> (ID: 4723817248).
DB Context [Test: test_register_user_email_already_exists]: Releasing connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x1198fbb20> (ID: 4723817248) to specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free before release: 4
DB Context [Test: test_register_user_email_already_exists]: Released connection <PoolConnectionProxy [released] 0x1198fbb20> (ID: 4723817248) to specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free after release: 5

tests/test_auth.py::test_register_and_login_with_new_wallet_successful                     INFO     HTTP     _client.py:1740
                             Request:                
                             POST                    
                             http://t                
                             est/api/                
                             auth/log                
                             in-walle                
                             t                       
                             "HTTP/1.                
                             1 422                   
                             Unproces                
                             sable                   
                             Entity"                 
DB Context [Test: test_register_and_login_with_new_wallet_successful]: Acquiring connection from specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool state: Size=1, Free=5
DB Context [Test: test_register_and_login_with_new_wallet_successful]: Acquired connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x1198fb490> (ID: 4723815568) from specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free: 4

-------------------------------- live log call ---------------------------------
2025-06-15 17:33:17 [    INFO] HTTP Request: POST http://test/api/auth/login-wallet "HTTP/1.1 422 Unprocessable Entity"
FAILEDDB Context [Test: test_register_and_login_with_new_wallet_successful]: Returned from yield for connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x1198fb490> (ID: 4723815568).
DB Context [Test: test_register_and_login_with_new_wallet_successful]: Releasing connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x1198fb490> (ID: 4723815568) to specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free before release: 4
DB Context [Test: test_register_and_login_with_new_wallet_successful]: Released connection <PoolConnectionProxy [released] 0x1198fb490> (ID: 4723815568) to specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free after release: 5

tests/test_auth.py::test_login_inactive_user [06/15/25 17:33:18] WARNING  Login        auth.py:585
                             attempt                 
                             failed: User            
                             inactive_use            
                             r_deec63a3-e            
                             308-4057-930            
                             5-343fa8ec53            
                             78@example.c            
                             om is                   
                             inactive.               
DB Context [Test: test_login_inactive_user]: Acquiring connection from specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool state: Size=1, Free=5
DB Context [Test: test_login_inactive_user]: Acquired connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x1198d9300> (ID: 4723675904) from specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free: 4

-------------------------------- live log call ---------------------------------
2025-06-15 17:33:18 [ WARNING] Login attempt failed: User inactive_user_deec63a3-e308-4057-9305-343fa8ec5378@example.com is inactive.
                    INFO     HTTP     _client.py:1740
                             Request:                
                             POST                    
                             http://t                
                             est/api/                
                             auth/log                
                             in                      
                             "HTTP/1.                
                             1 403                   
                             Forbidde                
                             n"                      
2025-06-15 17:33:18 [    INFO] HTTP Request: POST http://test/api/auth/login "HTTP/1.1 403 Forbidden"
FAILEDDB Context [Test: test_login_inactive_user]: Returned from yield for connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x1198d9300> (ID: 4723675904).
DB Context [Test: test_login_inactive_user]: Releasing connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x1198d9300> (ID: 4723675904) to specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free before release: 4
DB Context [Test: test_login_inactive_user]: Released connection <PoolConnectionProxy [released] 0x1198d9300> (ID: 4723675904) to specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free after release: 5

tests/test_auth.py::test_login_successful                     INFO     Updated      auth.py:603
                             last_login_a            
                             t for user              
                             0683682c-4a8            
                             e-494d-befe-            
                             7a75828b71bc            
DB Context [Test: test_login_successful]: Acquiring connection from specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool state: Size=1, Free=5
DB Context [Test: test_login_successful]: Acquired connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x1198db3a0> (ID: 4723684256) from specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free: 4

-------------------------------- live log call ---------------------------------
2025-06-15 17:33:18 [    INFO] Updated last_login_at for user 0683682c-4a8e-494d-befe-7a75828b71bc
                    ERROR    Unexpected   auth.py:628
                             error during            
                             login for               
                             login_succes            
                             s_5cb0a3f0-c            
                             531-4dea-bc9            
                             e-5d17549ad6            
                             63@example.c            
                             om:                     
                             TypeError -             
                             Object of               
                             type UUID is            
                             not JSON                
                             serializable            
2025-06-15 17:33:18 [   ERROR] Unexpected error during login for login_success_5cb0a3f0-c531-4dea-bc9e-5d17549ad663@example.com: TypeError - Object of type UUID is not JSON serializable
                    ERROR    Traceback    auth.py:630
                             (most recent            
                             call last):             
                               File                  
                             "/Users/boom            
                             mac/Download            
                             s/TAIC-Maste            
                             r/fastapi_ai            
                             _backend/app            
                             /routers/aut            
                             h.py", line             
                             617, in                 
                             login_for_ac            
                             cess_token              
                                 access_t            
                             oken =                  
                             create_acces            
                             s_token(data            
                             =token_data)            
                                                     
                                    ^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^                 
                               File                  
                             "/Users/boom            
                             mac/Download            
                             s/TAIC-Maste            
                             r/fastapi_ai            
                             _backend/app            
                             /security.py            
                             ", line 82,             
                             in                      
                             create_acces            
                             s_token                 
                                 encoded_            
                             jwt =                   
                             jwt.encode(t            
                             o_encode,               
                             SECRET_KEY,             
                             algorithm=AL            
                             GORITHM)                
                                                     
                                   ^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                               File                  
                             "/Users/boom            
                             mac/Download            
                             s/TAIC-Maste            
                             r/fastapi_ai            
                             _backend/ven            
                             v/lib/python            
                             3.11/site-pa            
                             ckages/jose/            
                             jwt.py",                
                             line 63, in             
                             encode                  
                                 return              
                             jws.sign(cla            
                             ims, key,               
                             headers=head            
                             ers,                    
                             algorithm=al            
                             gorithm)                
                                        ^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^              
                               File                  
                             "/Users/boom            
                             mac/Download            
                             s/TAIC-Maste            
                             r/fastapi_ai            
                             _backend/ven            
                             v/lib/python            
                             3.11/site-pa            
                             ckages/jose/            
                             jws.py",                
                             line 46, in             
                             sign                    
                                 encoded_            
                             payload =               
                             _encode_payl            
                             oad(payload)            
                                                     
                                       ^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^              
                               File                  
                             "/Users/boom            
                             mac/Download            
                             s/TAIC-Maste            
                             r/fastapi_ai            
                             _backend/ven            
                             v/lib/python            
                             3.11/site-pa            
                             ckages/jose/            
                             jws.py",                
                             line 150, in            
                             _encode_payl            
                             oad                     
                                 payload             
                             =                       
                             json.dumps(             
                                                     
                               ^^^^^^^^^^            
                             ^                       
                               File                  
                             "/usr/local/            
                             Cellar/pytho            
                             n@3.11/3.11.            
                             11/Framework            
                             s/Python.fra            
                             mework/Versi            
                             ons/3.11/lib            
                             /python3.11/            
                             json/__init_            
                             _.py", line             
                             238, in                 
                             dumps                   
                                 **kw).en            
                             code(obj)               
                                       ^^            
                             ^^^^^^^^^               
                               File                  
                             "/usr/local/            
                             Cellar/pytho            
                             n@3.11/3.11.            
                             11/Framework            
                             s/Python.fra            
                             mework/Versi            
                             ons/3.11/lib            
                             /python3.11/            
                             json/encoder            
                             .py", line              
                             200, in                 
                             encode                  
                                 chunks =            
                             self.iterenc            
                             ode(o,                  
                             _one_shot=Tr            
                             ue)                     
                                                     
                              ^^^^^^^^^^^            
                             ^^^^^^^^^^^^            
                             ^^^^^^^^^^^             
                               File                  
                             "/usr/local/            
                             Cellar/pytho            
                             n@3.11/3.11.            
                             11/Framework            
                             s/Python.fra            
                             mework/Versi            
                             ons/3.11/lib            
                             /python3.11/            
                             json/encoder            
                             .py", line              
                             258, in                 
                             iterencode              
                                 return              
                             _iterencode(            
                             o, 0)                   
                                        ^            
                             ^^^^^^^^^^^^            
                             ^^^^                    
                               File                  
                             "/usr/local/            
                             Cellar/pytho            
                             n@3.11/3.11.            
                             11/Framework            
                             s/Python.fra            
                             mework/Versi            
                             ons/3.11/lib            
                             /python3.11/            
                             json/encoder            
                             .py", line              
                             180, in                 
                             default                 
                                 raise               
                             TypeError(f'            
                             Object of               
                             type                    
                             {o.__class__            
                             .__name__} '            
                             TypeError:              
                             Object of               
                             type UUID is            
                             not JSON                
                             serializable            
                                                     
2025-06-15 17:33:18 [   ERROR] Traceback (most recent call last):
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/app/routers/auth.py", line 617, in login_for_access_token
    access_token = create_access_token(data=token_data)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/app/security.py", line 82, in create_access_token
    encoded_jwt = jwt.encode(to_encode, SECRET_KEY, algorithm=ALGORITHM)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jwt.py", line 63, in encode
    return jws.sign(claims, key, headers=headers, algorithm=algorithm)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jws.py", line 46, in sign
    encoded_payload = _encode_payload(payload)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jws.py", line 150, in _encode_payload
    payload = json.dumps(
              ^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
          ^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           ^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type UUID is not JSON serializable

                    INFO     HTTP     _client.py:1740
                             Request:                
                             POST                    
                             http://t                
                             est/api/                
                             auth/log                
                             in                      
                             "HTTP/1.                
                             1 500                   
                             Internal                
                             Server                  
                             Error"                  
2025-06-15 17:33:18 [    INFO] HTTP Request: POST http://test/api/auth/login "HTTP/1.1 500 Internal Server Error"
FAILEDDB Context [Test: test_login_successful]: Returned from yield for connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x1198db3a0> (ID: 4723684256).
DB Context [Test: test_login_successful]: Releasing connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x1198db3a0> (ID: 4723684256) to specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free before release: 4
DB Context [Test: test_login_successful]: Released connection <PoolConnectionProxy [released] 0x1198db3a0> (ID: 4723684256) to specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free after release: 5

tests/test_auth.py::test_link_wallet_same_wallet_linked_not_verified [06/15/25 17:33:19] INFO     HTTP     _client.py:1740
                             Request:                
                             POST                    
                             http://t                
                             est/api/                
                             auth/lin                
                             k-wallet                
                                                     
                             "HTTP/1.                
                             1 422                   
                             Unproces                
                             sable                   
                             Entity"                 
DB Context [Test: test_link_wallet_same_wallet_linked_not_verified]: Acquiring connection from specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool state: Size=1, Free=5
DB Context [Test: test_link_wallet_same_wallet_linked_not_verified]: Acquired connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x119bfb340> (ID: 4726960960) from specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free: 4

-------------------------------- live log call ---------------------------------
2025-06-15 17:33:19 [    INFO] HTTP Request: POST http://test/api/auth/link-wallet "HTTP/1.1 422 Unprocessable Entity"
FAILEDDB Context [Test: test_link_wallet_same_wallet_linked_not_verified]: Returned from yield for connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x119bfb340> (ID: 4726960960).
DB Context [Test: test_link_wallet_same_wallet_linked_not_verified]: Releasing connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x119bfb340> (ID: 4726960960) to specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free before release: 4
DB Context [Test: test_link_wallet_same_wallet_linked_not_verified]: Released connection <PoolConnectionProxy [released] 0x119bfb340> (ID: 4726960960) to specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free after release: 5

tests/test_auth.py::test_login_wallet_invalid_signature                     INFO     HTTP     _client.py:1740
                             Request:                
                             POST                    
                             http://t                
                             est/api/                
                             auth/log                
                             in-walle                
                             t                       
                             "HTTP/1.                
                             1 422                   
                             Unproces                
                             sable                   
                             Entity"                 

-------------------------------- live log call ---------------------------------
2025-06-15 17:33:19 [    INFO] HTTP Request: POST http://test/api/auth/login-wallet "HTTP/1.1 422 Unprocessable Entity"
FAILED
tests/test_auth.py::test_read_users_me_user_not_found_in_db                     INFO     HTTP     _client.py:1740
                             Request:                
                             GET                     
                             http://t                
                             est/api/                
                             users/me                
                                                     
                             "HTTP/1.                
                             1 401                   
                             Unauthor                
                             ized"                   

-------------------------------- live log call ---------------------------------
2025-06-15 17:33:19 [    INFO] HTTP Request: GET http://test/api/users/me "HTTP/1.1 401 Unauthorized"
PASSED
tests/test_auth.py::test_login_non_existent_email                     WARNING  Login        auth.py:576
                             attempt                 
                             failed: User            
                             not found               
                             for email               
                             non_existent            
                             _40d277cd-a9            
                             21-4ff4-b939            
                             -67ef58f32ab            
                             3@example.co            
                             m                       

-------------------------------- live log call ---------------------------------
2025-06-15 17:33:19 [ WARNING] Login attempt failed: User not found for email non_existent_40d277cd-a921-4ff4-b939-67ef58f32ab3@example.com
                    INFO     HTTP     _client.py:1740
                             Request:                
                             POST                    
                             http://t                
                             est/api/                
                             auth/log                
                             in                      
                             "HTTP/1.                
                             1 401                   
                             Unauthor                
                             ized"                   
2025-06-15 17:33:19 [    INFO] HTTP Request: POST http://test/api/auth/login "HTTP/1.1 401 Unauthorized"
PASSED
tests/test_auth.py::test_register_user_invalid_input[invalid_payload3-Field required] [06/15/25 17:33:20] INFO     User          auth.py:88
                             'missing_role           
                             _37168127-d6a           
                             0-4e95-9cc0-d           
                             32f3f3f2ddb@e           
                             xample.com'             
                             (ID:                    
                             15c021b5-efc5           
                             -4b37-bf1b-16           
                             c56a17a608)             
                             registered              
                             successfully            
                             as 'SHOPPER'.           

-------------------------------- live log call ---------------------------------
2025-06-15 17:33:20 [    INFO] User 'missing_role_37168127-d6a0-4e95-9cc0-d32f3f3f2ddb@example.com' (ID: 15c021b5-efc5-4b37-bf1b-16c56a17a608) registered successfully as 'SHOPPER'.
                    WARNING  Resen email_utils.py:164
                             d API                   
                             key                     
                             not                     
                             confi                   
                             gured                   
                             .                       
                             Skipp                   
                             ing                     
                             actua                   
                             l                       
                             email                   
                             send                    
                             to                      
                             missi                   
                             ng_ro                   
                             le_37                   
                             16812                   
                             7-d6a                   
                             0-4e9                   
                             5-9cc                   
                             0-d32                   
                             f3f3f                   
                             2ddb@                   
                             examp                   
                             le.co                   
                             m                       
                             with                    
                             subje                   
                             ct:                     
                             Welco                   
                             me to                   
                             TAIC!                   
                             Your                    
                             Adven                   
                             ture                    
                             Await                   
                             s!                      
2025-06-15 17:33:20 [ WARNING] Resend API key not configured. Skipping actual email send to missing_role_37168127-d6a0-4e95-9cc0-d32f3f3f2ddb@example.com with subject: Welcome to TAIC! Your Adventure Awaits!
                    INFO     ---   email_utils.py:165
                             EMAIL                   
                             CONTE                   
                             NT                      
                             (SIMU                   
                             LATED                   
                                                     
                             SEND)                   
                             ---                     
2025-06-15 17:33:20 [    INFO] --- EMAIL CONTENT (SIMULATED SEND) ---
                    INFO     To:   email_utils.py:166
                             missi                   
                             ng_ro                   
                             le_37                   
                             16812                   
                             7-d6a                   
                             0-4e9                   
                             5-9cc                   
                             0-d32                   
                             f3f3f                   
                             2ddb@                   
                             examp                   
                             le.co                   
                             m                       
2025-06-15 17:33:20 [    INFO] To: missing_role_37168127-d6a0-4e95-9cc0-d32f3f3f2ddb@example.com
                    INFO     Subje email_utils.py:167
                             ct:                     
                             Welco                   
                             me to                   
                             TAIC!                   
                             Your                    
                             Adven                   
                             ture                    
                             Await                   
                             s!                      
2025-06-15 17:33:20 [    INFO] Subject: Welcome to TAIC! Your Adventure Awaits!
                    INFO     Body  email_utils.py:168
                             (Text                   
                             ):                      
                             Hello                   
                             missi                   
                             ng_ro                   
                             le_37                   
                             16812                   
                             7-d6a                   
                             0-4e9                   
                             5-9cc                   
                             0-d32                   
                             f3f3f                   
                             2ddb@                   
                             examp                   
                             le.co                   
                             m,                      
                                                     
                             Welco                   
                             me to                   
                             TAIC                    
                             - The                   
                             AI-Po                   
                             wered                   
                                                     
                             Crypt                   
                             o                       
                             Comme                   
                             rce                     
                             Marke                   
                             tplac                   
                             e!                      
                                                     
                             We're                   
                             thril                   
                             led                     
                             to                      
                             have                    
                             you                     
                             join                    
                             our                     
                             commu                   
                             nity.                   
                              Get                    
                             ready                   
                             to                      
                             explo                   
                             re a                    
                             new                     
                             era                     
                             of                      
                             onlin                   
                             e                       
                             shopp                   
                             ing                     
                             where                   
                             innov                   
                             ation                   
                                                     
                             meets                   
                             conve                   
                             nienc                   
                             e.                      
                                                     
                             Here'                   
                             s                       
                             what                    
                             you                     
                             can                     
                             do on                   
                             TAIC:                   
                             ...                     
2025-06-15 17:33:20 [    INFO] Body (Text): 
Hello missing_role_37168127-d6a0-4e95-9cc0-d32f3f3f2ddb@example.com,

Welcome to TAIC - The AI-Powered Crypto Commerce Marketplace!

We're thrilled to have you join our community. Get ready to explore a new era of online shopping where innovation meets convenience.

Here's what you can do on TAIC:
...
                    INFO     Body  email_utils.py:169
                             (HTML                   
                             ):                      
                             <!DOC                   
                             TYPE                    
                             html>                   
                             <html                   
                             >                       
                             <head                   
                             >                       
                                 <                   
                             title                   
                             >Welc                   
                             ome                     
                             to                      
                             TAIC!                   
                             </tit                   
                             le>                     
                                 <                   
                             style                   
                             >                       
                                                     
                                bo                   
                             dy {                    
                             font-                   
                             famil                   
                             y:                      
                             Arial                   
                             ,                       
                             sans-                   
                             serif                   
                             ;                       
                             margi                   
                             n: 0;                   
                             paddi                   
                             ng:                     
                             20px;                   
                             color                   
                             :                       
                             #333;                   
                             }                       
                                                     
                                .c                   
                             ontai                   
                             ner {                   
                             backg                   
                             round                   
                             -colo                   
                             r:                      
                             #f9f9                   
                             f9;                     
                             paddi                   
                             ng:                     
                             20px;                   
                             borde                   
                             r-rad                   
                             ius:                    
                             8px;                    
                             }                       
                                                     
                                .h                   
                             eader                   
                              {                      
                             font-                   
                             size:                   
                                                     
                             24px;                   
                             font-                   
                             weigh                   
                             t:                      
                             ...                     
2025-06-15 17:33:20 [    INFO] Body (HTML): 
<!DOCTYPE html>
<html>
<head>
    <title>Welcome to TAIC!</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 20px; color: #333; }
        .container { background-color: #f9f9f9; padding: 20px; border-radius: 8px; }
        .header { font-size: 24px; font-weight: ...
                    INFO     ---   email_utils.py:170
                             END                     
                             SIMUL                   
                             ATED                    
                             EMAIL                   
                             SEND                    
                             ---                     
2025-06-15 17:33:20 [    INFO] --- END SIMULATED EMAIL SEND ---
                    WARNING  Welcome      auth.py:113
                             email                   
                             simulation              
                             reported                
                             failure for             
                             missing_role            
                             _37168127-d6            
                             a0-4e95-9cc0            
                             -d32f3f3f2dd            
                             b@example.co            
                             m (role:                
                             SHOPPER).               
2025-06-15 17:33:20 [ WARNING] Welcome email simulation reported failure for missing_role_37168127-d6a0-4e95-9cc0-d32f3f3f2ddb@example.com (role: SHOPPER).
                    INFO     HTTP     _client.py:1740
                             Request:                
                             POST                    
                             http://t                
                             est/api/                
                             auth/reg                
                             ister                   
                             "HTTP/1.                
                             1 201                   
                             Created"                
2025-06-15 17:33:20 [    INFO] HTTP Request: POST http://test/api/auth/register "HTTP/1.1 201 Created"
FAILED
tests/test_auth.py::test_link_wallet_invalid_signature                     INFO     HTTP     _client.py:1740
                             Request:                
                             POST                    
                             http://t                
                             est/api/                
                             auth/lin                
                             k-wallet                
                                                     
                             "HTTP/1.                
                             1 422                   
                             Unproces                
                             sable                   
                             Entity"                 
DB Context [Test: test_link_wallet_invalid_signature]: Acquiring connection from specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool state: Size=1, Free=5
DB Context [Test: test_link_wallet_invalid_signature]: Acquired connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x117640970> (ID: 4687399280) from specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free: 4

-------------------------------- live log call ---------------------------------
2025-06-15 17:33:20 [    INFO] HTTP Request: POST http://test/api/auth/link-wallet "HTTP/1.1 422 Unprocessable Entity"
FAILEDDB Context [Test: test_link_wallet_invalid_signature]: Returned from yield for connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x117640970> (ID: 4687399280).
DB Context [Test: test_link_wallet_invalid_signature]: Releasing connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x117640970> (ID: 4687399280) to specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free before release: 4
DB Context [Test: test_link_wallet_invalid_signature]: Released connection <PoolConnectionProxy [released] 0x117640970> (ID: 4687399280) to specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free after release: 5

tests/test_auth.py::test_link_wallet_successful [06/15/25 17:33:21] INFO     HTTP     _client.py:1740
                             Request:                
                             POST                    
                             http://t                
                             est/api/                
                             auth/lin                
                             k-wallet                
                                                     
                             "HTTP/1.                
                             1 422                   
                             Unproces                
                             sable                   
                             Entity"                 
DB Context [Test: test_link_wallet_successful]: Acquiring connection from specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool state: Size=1, Free=5
DB Context [Test: test_link_wallet_successful]: Acquired connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x119998910> (ID: 4724459792) from specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free: 4

-------------------------------- live log call ---------------------------------
2025-06-15 17:33:21 [    INFO] HTTP Request: POST http://test/api/auth/link-wallet "HTTP/1.1 422 Unprocessable Entity"
FAILEDDB Context [Test: test_link_wallet_successful]: Returned from yield for connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x119998910> (ID: 4724459792).
DB Context [Test: test_link_wallet_successful]: Releasing connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x119998910> (ID: 4724459792) to specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free before release: 4
DB Context [Test: test_link_wallet_successful]: Released connection <PoolConnectionProxy [released] 0x119998910> (ID: 4724459792) to specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free after release: 5

tests/test_auth.py::test_link_email_password_successful                     INFO     Email        auth.py:251
                             linkable_ema            
                             il_03ed597d-            
                             b262-4b81-a5            
                             33-f5c32e082            
                             1f5@example.            
                             com and                 
                             password                
                             successfully            
                             linked to               
                             user                    
                             f243b589-97d            
                             f-47bb-828a-            
                             eafaa3362c97            
                             .                       
DB Context [Test: test_link_email_password_successful]: Acquiring connection from specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool state: Size=1, Free=5
DB Context [Test: test_link_email_password_successful]: Acquired connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x119bf8d90> (ID: 4726951312) from specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free: 4

-------------------------------- live log call ---------------------------------
2025-06-15 17:33:21 [    INFO] Email linkable_email_03ed597d-b262-4b81-a533-f5c32e0821f5@example.com and password successfully linked to user f243b589-97df-47bb-828a-eafaa3362c97.
                    INFO     TODO:        auth.py:254
                             Trigger                 
                             email                   
                             verification            
                             flow for                
                             user                    
                             f243b589-97d            
                             f-47bb-828a-            
                             eafaa3362c97            
                              and email              
                             linkable_ema            
                             il_03ed597d-            
                             b262-4b81-a5            
                             33-f5c32e082            
                             1f5@example.            
                             com                     
2025-06-15 17:33:21 [    INFO] TODO: Trigger email verification flow for user f243b589-97df-47bb-828a-eafaa3362c97 and email linkable_email_03ed597d-b262-4b81-a533-f5c32e0821f5@example.com
                    INFO     HTTP     _client.py:1740
                             Request:                
                             POST                    
                             http://t                
                             est/api/                
                             auth/lin                
                             k-email-                
                             password                
                                                     
                             "HTTP/1.                
                             1 200                   
                             OK"                     
2025-06-15 17:33:21 [    INFO] HTTP Request: POST http://test/api/auth/link-email-password "HTTP/1.1 200 OK"
PASSEDDB Context [Test: test_link_email_password_successful]: Returned from yield for connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x119bf8d90> (ID: 4726951312).
DB Context [Test: test_link_email_password_successful]: Releasing connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x119bf8d90> (ID: 4726951312) to specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free before release: 4
DB Context [Test: test_link_email_password_successful]: Released connection <PoolConnectionProxy [released] 0x119bf8d90> (ID: 4726951312) to specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free after release: 5

tests/test_auth.py::test_link_email_password_new_email_already_used_by_other [06/15/25 17:33:22] WARNING  User         auth.py:213
                             02576c8c-742            
                             a-45bb-a52d-            
                             a0ff8f0370a6            
                              attempted              
                             to link                 
                             email                   
                             taken_email_            
                             85e293c6-285            
                             c-4bbb-97b7-            
                             2b7bf89ecd6f            
                             @example.com            
                              which is               
                             already used            
                             by user                 
                             9966d101-a1e            
                             6-4970-8284-            
                             cdc2e7f33fdb            
                             .                       
DB Context [Test: test_link_email_password_new_email_already_used_by_other]: Acquiring connection from specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool state: Size=1, Free=5
DB Context [Test: test_link_email_password_new_email_already_used_by_other]: Acquired connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x1198c5d50> (ID: 4723596624) from specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free: 4

-------------------------------- live log call ---------------------------------
2025-06-15 17:33:22 [ WARNING] User 02576c8c-742a-45bb-a52d-a0ff8f0370a6 attempted to link email taken_email_85e293c6-285c-4bbb-97b7-2b7bf89ecd6f@example.com which is already used by user 9966d101-a1e6-4970-8284-cdc2e7f33fdb.
                    INFO     HTTP     _client.py:1740
                             Request:                
                             POST                    
                             http://t                
                             est/api/                
                             auth/lin                
                             k-email-                
                             password                
                                                     
                             "HTTP/1.                
                             1 409                   
                             Conflict                
                             "                       
2025-06-15 17:33:22 [    INFO] HTTP Request: POST http://test/api/auth/link-email-password "HTTP/1.1 409 Conflict"
PASSEDDB Context [Test: test_link_email_password_new_email_already_used_by_other]: Returned from yield for connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x1198c5d50> (ID: 4723596624).
DB Context [Test: test_link_email_password_new_email_already_used_by_other]: Releasing connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x1198c5d50> (ID: 4723596624) to specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free before release: 4
DB Context [Test: test_link_email_password_new_email_already_used_by_other]: Released connection <PoolConnectionProxy [released] 0x1198c5d50> (ID: 4723596624) to specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free after release: 5

tests/test_auth.py::test_link_email_password_invalid_input[invalid_payload2-Field required]                     INFO     HTTP     _client.py:1740
                             Request:                
                             POST                    
                             http://t                
                             est/api/                
                             auth/lin                
                             k-email-                
                             password                
                                                     
                             "HTTP/1.                
                             1 422                   
                             Unproces                
                             sable                   
                             Entity"                 
DB Context [Test: test_link_email_password_invalid_input[invalid_payload2-Field required]]: Acquiring connection from specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool state: Size=1, Free=5
DB Context [Test: test_link_email_password_invalid_input[invalid_payload2-Field required]]: Acquired connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x1198c5b40> (ID: 4723596096) from specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free: 4

-------------------------------- live log call ---------------------------------
2025-06-15 17:33:22 [    INFO] HTTP Request: POST http://test/api/auth/link-email-password "HTTP/1.1 422 Unprocessable Entity"
PASSEDDB Context [Test: test_link_email_password_invalid_input[invalid_payload2-Field required]]: Returned from yield for connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x1198c5b40> (ID: 4723596096).
DB Context [Test: test_link_email_password_invalid_input[invalid_payload2-Field required]]: Releasing connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x1198c5b40> (ID: 4723596096) to specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free before release: 4
DB Context [Test: test_link_email_password_invalid_input[invalid_payload2-Field required]]: Released connection <PoolConnectionProxy [released] 0x1198c5b40> (ID: 4723596096) to specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free after release: 5

tests/test_auth.py::test_read_users_me_success [06/15/25 17:33:23] INFO     HTTP     _client.py:1740
                             Request:                
                             GET                     
                             http://t                
                             est/api/                
                             users/me                
                                                     
                             "HTTP/1.                
                             1 200                   
                             OK"                     
DB Context [Test: test_read_users_me_success]: Acquiring connection from specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool state: Size=1, Free=5
DB Context [Test: test_read_users_me_success]: Acquired connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x1198c5480> (ID: 4723594368) from specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free: 4

-------------------------------- live log call ---------------------------------
2025-06-15 17:33:23 [    INFO] HTTP Request: GET http://test/api/users/me "HTTP/1.1 200 OK"
PASSEDDB Context [Test: test_read_users_me_success]: Returned from yield for connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x1198c5480> (ID: 4723594368).
DB Context [Test: test_read_users_me_success]: Releasing connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x1198c5480> (ID: 4723594368) to specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free before release: 4
DB Context [Test: test_read_users_me_success]: Released connection <PoolConnectionProxy [released] 0x1198c5480> (ID: 4723594368) to specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free after release: 5

tests/test_auth.py::test_login_wallet_inactive_user                     INFO     HTTP     _client.py:1740
                             Request:                
                             POST                    
                             http://t                
                             est/api/                
                             auth/log                
                             in-walle                
                             t                       
                             "HTTP/1.                
                             1 422                   
                             Unproces                
                             sable                   
                             Entity"                 
DB Context [Test: test_login_wallet_inactive_user]: Acquiring connection from specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool state: Size=1, Free=5
DB Context [Test: test_login_wallet_inactive_user]: Acquired connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x117677fa0> (ID: 4687626144) from specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free: 4

-------------------------------- live log call ---------------------------------
2025-06-15 17:33:23 [    INFO] HTTP Request: POST http://test/api/auth/login-wallet "HTTP/1.1 422 Unprocessable Entity"
FAILEDDB Context [Test: test_login_wallet_inactive_user]: Returned from yield for connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x117677fa0> (ID: 4687626144).
DB Context [Test: test_login_wallet_inactive_user]: Releasing connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x117677fa0> (ID: 4687626144) to specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free before release: 4
DB Context [Test: test_login_wallet_inactive_user]: Released connection <PoolConnectionProxy [released] 0x117677fa0> (ID: 4687626144) to specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free after release: 5

tests/test_auth.py::test_link_wallet_unauthenticated                     INFO     HTTP     _client.py:1740
                             Request:                
                             POST                    
                             http://t                
                             est/api/                
                             auth/lin                
                             k-wallet                
                                                     
                             "HTTP/1.                
                             1 401                   
                             Unauthor                
                             ized"                   

-------------------------------- live log call ---------------------------------
2025-06-15 17:33:23 [    INFO] HTTP Request: POST http://test/api/auth/link-wallet "HTTP/1.1 401 Unauthorized"
PASSED
tests/test_auth.py::test_link_wallet_same_wallet_already_linked_and_verified [06/15/25 17:33:24] INFO     HTTP     _client.py:1740
                             Request:                
                             POST                    
                             http://t                
                             est/api/                
                             auth/lin                
                             k-wallet                
                                                     
                             "HTTP/1.                
                             1 422                   
                             Unproces                
                             sable                   
                             Entity"                 
DB Context [Test: test_link_wallet_same_wallet_already_linked_and_verified]: Acquiring connection from specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool state: Size=1, Free=5
DB Context [Test: test_link_wallet_same_wallet_already_linked_and_verified]: Acquired connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x117675600> (ID: 4687615488) from specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free: 4

-------------------------------- live log call ---------------------------------
2025-06-15 17:33:24 [    INFO] HTTP Request: POST http://test/api/auth/link-wallet "HTTP/1.1 422 Unprocessable Entity"
FAILEDDB Context [Test: test_link_wallet_same_wallet_already_linked_and_verified]: Returned from yield for connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x117675600> (ID: 4687615488).
DB Context [Test: test_link_wallet_same_wallet_already_linked_and_verified]: Releasing connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x117675600> (ID: 4687615488) to specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free before release: 4
DB Context [Test: test_link_wallet_same_wallet_already_linked_and_verified]: Released connection <PoolConnectionProxy [released] 0x117675600> (ID: 4687615488) to specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free after release: 5

tests/test_auth.py::test_link_email_password_account_already_has_email                     WARNING  User         auth.py:201
                             a2869ca1-627            
                             6-44dd-88eb-            
                             bd963d4588d8            
                              attempted              
                             to link                 
                             email                   
                             new_try_90dc            
                             a40e-6172-41            
                             ba-9151-71d8            
                             798ae943@exa            
                             mple.com but            
                             an email                
                             (current_ema            
                             il_6da0e2b8-            
                             22a6-4363-a7            
                             66-14e000b9d            
                             954@example.            
                             com) is                 
                             already                 
                             linked.                 
DB Context [Test: test_link_email_password_account_already_has_email]: Acquiring connection from specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool state: Size=1, Free=5
DB Context [Test: test_link_email_password_account_already_has_email]: Acquired connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x117676860> (ID: 4687620192) from specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free: 4

-------------------------------- live log call ---------------------------------
2025-06-15 17:33:24 [ WARNING] User a2869ca1-6276-44dd-88eb-bd963d4588d8 attempted to link email new_try_90dca40e-6172-41ba-9151-71d8798ae943@example.com but an email (current_email_6da0e2b8-22a6-4363-a766-14e000b9d954@example.com) is already linked.
                    INFO     HTTP     _client.py:1740
                             Request:                
                             POST                    
                             http://t                
                             est/api/                
                             auth/lin                
                             k-email-                
                             password                
                                                     
                             "HTTP/1.                
                             1 400                   
                             Bad                     
                             Request"                
2025-06-15 17:33:24 [    INFO] HTTP Request: POST http://test/api/auth/link-email-password "HTTP/1.1 400 Bad Request"
PASSEDDB Context [Test: test_link_email_password_account_already_has_email]: Returned from yield for connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x117676860> (ID: 4687620192).
DB Context [Test: test_link_email_password_account_already_has_email]: Releasing connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x117676860> (ID: 4687620192) to specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free before release: 4
DB Context [Test: test_link_email_password_account_already_has_email]: Released connection <PoolConnectionProxy [released] 0x117676860> (ID: 4687620192) to specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free after release: 5

tests/test_auth.py::test_read_users_me_no_token                     INFO     HTTP     _client.py:1740
                             Request:                
                             GET                     
                             http://t                
                             est/api/                
                             users/me                
                                                     
                             "HTTP/1.                
                             1 401                   
                             Unauthor                
                             ized"                   

-------------------------------- live log call ---------------------------------
2025-06-15 17:33:24 [    INFO] HTTP Request: GET http://test/api/users/me "HTTP/1.1 401 Unauthorized"
PASSED
tests/test_auth.py::test_read_users_me_inactive_user DB Context [Test: test_read_users_me_inactive_user]: Acquiring connection from specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool state: Size=1, Free=5
DB Context [Test: test_read_users_me_inactive_user]: Acquired connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x1198f99c0> (ID: 4723808704) from specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free: 4
DB Context [Test: test_read_users_me_inactive_user]: Returned from yield for connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x1198f99c0> (ID: 4723808704).
DB Context [Test: test_read_users_me_inactive_user]: Releasing connection <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x1198f99c0> (ID: 4723808704) to specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free before release: 4
DB Context [Test: test_read_users_me_inactive_user]: Released connection <PoolConnectionProxy [released] 0x1198f99c0> (ID: 4723808704) to specific pool <asyncpg.pool.Pool object at 0x1198b2c20> (ID: 4723518496). Pool free after release: 5

pytest_conftest: test_db fixture - Post-yield cleanup starting (TRUNCATE tables)...
pytest_conftest: test_db fixture - Acquired connection for TRUNCATE.
pytest_conftest: test_db fixture - TRUNCATE successful.
pytest_conftest: test_db fixture - Connection for TRUNCATE (if acquired) released by 'async with'.
pytest_conftest: test_db fixture - Post-yield cleanup finished.

pytest_conftest: test_db fixture - Starting 'finally' block for teardown...
pytest_conftest: test_db fixture - Restoring global POOL...
pytest_conftest: test_db fixture - Global POOL restored.
pytest_conftest: test_db fixture - Restoring app.state.pool...
pytest_conftest: test_db fixture - app.state.pool restored.
pytest_conftest: test_db fixture - Attempting to close fixture_pool...
pytest_conftest: test_db fixture - fixture_pool closed successfully.
pytest_conftest: test_db fixture - 'finally' block teardown complete.


==================================== ERRORS ====================================
________________ ERROR at setup of test_update_product_variant _________________
venv/lib/python3.11/site-packages/pytest_asyncio/plugin.py:293: in _asyncgen_fixture_wrapper
    result = event_loop.run_until_complete(setup())
        event_loop = <_UnixSelectorEventLoop running=False closed=False debug=False>
        finalizer  = <function _wrap_asyncgen.<locals>._asyncgen_fixture_wrapper.<locals>.finalizer at 0x11765d6c0>
        func       = <function auth_client at 0x1175a44a0>
        gen_obj    = <async_generator object auth_client at 0x11724e700>
        kwargs     = {'client': <httpx.AsyncClient object at 0x117465910>}
        request    = <SubRequest 'auth_client' for <Function test_update_product_variant>>
        setup      = <function _wrap_asyncgen.<locals>._asyncgen_fixture_wrapper.<locals>.setup at 0x11765da80>
/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py:654: in run_until_complete
    return future.result()
        future     = <Task finished name='Task-5' coro=<_wrap_asyncgen.<locals>._asyncgen_fixture_wrapper.<locals>.setup() done, defined at /Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/pytest_asyncio/plugin.py:274> exception=AssertionError('Login failed: {"detail":"An unexpected error occurred during login."}\nassert 500 == 200\n +  where 500 = <Response [500 Internal Server Error]>.status_code')>
        new_task   = True
        self       = <_UnixSelectorEventLoop running=False closed=False debug=False>
venv/lib/python3.11/site-packages/pytest_asyncio/plugin.py:275: in setup
    res = await gen_obj.__anext__()
        gen_obj    = <async_generator object auth_client at 0x11724e700>
tests/conftest.py:239: in auth_client
    assert response.status_code == 200, f"Login failed: {response.text}"
E   AssertionError: Login failed: {"detail":"An unexpected error occurred during login."}
E   assert 500 == 200
E    +  where 500 = <Response [500 Internal Server Error]>.status_code
        client     = <httpx.AsyncClient object at 0x117465910>
        login_data = {'email': 'test@example.com', 'password': 'testpassword'}
        response   = <Response [500 Internal Server Error]>
------------------------------ Captured log setup ------------------------------
INFO     app.routers.auth:auth.py:603 Updated last_login_at for user 7f859d71-1340-411d-bcc3-2677e8dc6de8
ERROR    app.routers.auth:auth.py:628 Unexpected error during login for test@example.com: TypeError - Object of type UUID is not JSON serializable
ERROR    app.routers.auth:auth.py:630 Traceback (most recent call last):
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/app/routers/auth.py", line 617, in login_for_access_token
    access_token = create_access_token(data=token_data)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/app/security.py", line 82, in create_access_token
    encoded_jwt = jwt.encode(to_encode, SECRET_KEY, algorithm=ALGORITHM)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jwt.py", line 63, in encode
    return jws.sign(claims, key, headers=headers, algorithm=algorithm)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jws.py", line 46, in sign
    encoded_payload = _encode_payload(payload)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jws.py", line 150, in _encode_payload
    payload = json.dumps(
              ^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
          ^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           ^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type UUID is not JSON serializable

INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 500 Internal Server Error"
________________ ERROR at setup of test_delete_product_variant _________________
venv/lib/python3.11/site-packages/pytest_asyncio/plugin.py:293: in _asyncgen_fixture_wrapper
    result = event_loop.run_until_complete(setup())
        event_loop = <_UnixSelectorEventLoop running=False closed=False debug=False>
        finalizer  = <function _wrap_asyncgen.<locals>._asyncgen_fixture_wrapper.<locals>.finalizer at 0x119885440>
        func       = <function auth_client at 0x1175a44a0>
        gen_obj    = <async_generator object auth_client at 0x11724e840>
        kwargs     = {'client': <httpx.AsyncClient object at 0x117465910>}
        request    = <SubRequest 'auth_client' for <Function test_delete_product_variant>>
        setup      = <function _wrap_asyncgen.<locals>._asyncgen_fixture_wrapper.<locals>.setup at 0x119885c60>
/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py:654: in run_until_complete
    return future.result()
        future     = <Task finished name='Task-15' coro=<_wrap_asyncgen.<locals>._asyncgen_fixture_wrapper.<locals>.setup() done, defined at /Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/pytest_asyncio/plugin.py:274> exception=AssertionError('Login failed: {"detail":"An unexpected error occurred during login."}\nassert 500 == 200\n +  where 500 = <Response [500 Internal Server Error]>.status_code')>
        new_task   = True
        self       = <_UnixSelectorEventLoop running=False closed=False debug=False>
venv/lib/python3.11/site-packages/pytest_asyncio/plugin.py:275: in setup
    res = await gen_obj.__anext__()
        gen_obj    = <async_generator object auth_client at 0x11724e840>
tests/conftest.py:239: in auth_client
    assert response.status_code == 200, f"Login failed: {response.text}"
E   AssertionError: Login failed: {"detail":"An unexpected error occurred during login."}
E   assert 500 == 200
E    +  where 500 = <Response [500 Internal Server Error]>.status_code
        client     = <httpx.AsyncClient object at 0x117465910>
        login_data = {'email': 'test@example.com', 'password': 'testpassword'}
        response   = <Response [500 Internal Server Error]>
------------------------------ Captured log setup ------------------------------
INFO     app.routers.auth:auth.py:603 Updated last_login_at for user 7f859d71-1340-411d-bcc3-2677e8dc6de8
ERROR    app.routers.auth:auth.py:628 Unexpected error during login for test@example.com: TypeError - Object of type UUID is not JSON serializable
ERROR    app.routers.auth:auth.py:630 Traceback (most recent call last):
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/app/routers/auth.py", line 617, in login_for_access_token
    access_token = create_access_token(data=token_data)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/app/security.py", line 82, in create_access_token
    encoded_jwt = jwt.encode(to_encode, SECRET_KEY, algorithm=ALGORITHM)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jwt.py", line 63, in encode
    return jws.sign(claims, key, headers=headers, algorithm=algorithm)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jws.py", line 46, in sign
    encoded_payload = _encode_payload(payload)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jws.py", line 150, in _encode_payload
    payload = json.dumps(
              ^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
          ^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           ^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type UUID is not JSON serializable

INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 500 Internal Server Error"
________________ ERROR at setup of test_create_product_variant _________________
venv/lib/python3.11/site-packages/pytest_asyncio/plugin.py:293: in _asyncgen_fixture_wrapper
    result = event_loop.run_until_complete(setup())
        event_loop = <_UnixSelectorEventLoop running=False closed=False debug=False>
        finalizer  = <function _wrap_asyncgen.<locals>._asyncgen_fixture_wrapper.<locals>.finalizer at 0x119886480>
        func       = <function auth_client at 0x1175a44a0>
        gen_obj    = <async_generator object auth_client at 0x11724e980>
        kwargs     = {'client': <httpx.AsyncClient object at 0x117465910>}
        request    = <SubRequest 'auth_client' for <Function test_create_product_variant>>
        setup      = <function _wrap_asyncgen.<locals>._asyncgen_fixture_wrapper.<locals>.setup at 0x119885ee0>
/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py:654: in run_until_complete
    return future.result()
        future     = <Task finished name='Task-22' coro=<_wrap_asyncgen.<locals>._asyncgen_fixture_wrapper.<locals>.setup() done, defined at /Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/pytest_asyncio/plugin.py:274> exception=AssertionError('Login failed: {"detail":"An unexpected error occurred during login."}\nassert 500 == 200\n +  where 500 = <Response [500 Internal Server Error]>.status_code')>
        new_task   = True
        self       = <_UnixSelectorEventLoop running=False closed=False debug=False>
venv/lib/python3.11/site-packages/pytest_asyncio/plugin.py:275: in setup
    res = await gen_obj.__anext__()
        gen_obj    = <async_generator object auth_client at 0x11724e980>
tests/conftest.py:239: in auth_client
    assert response.status_code == 200, f"Login failed: {response.text}"
E   AssertionError: Login failed: {"detail":"An unexpected error occurred during login."}
E   assert 500 == 200
E    +  where 500 = <Response [500 Internal Server Error]>.status_code
        client     = <httpx.AsyncClient object at 0x117465910>
        login_data = {'email': 'test@example.com', 'password': 'testpassword'}
        response   = <Response [500 Internal Server Error]>
------------------------------ Captured log setup ------------------------------
INFO     app.routers.auth:auth.py:603 Updated last_login_at for user 7f859d71-1340-411d-bcc3-2677e8dc6de8
ERROR    app.routers.auth:auth.py:628 Unexpected error during login for test@example.com: TypeError - Object of type UUID is not JSON serializable
ERROR    app.routers.auth:auth.py:630 Traceback (most recent call last):
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/app/routers/auth.py", line 617, in login_for_access_token
    access_token = create_access_token(data=token_data)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/app/security.py", line 82, in create_access_token
    encoded_jwt = jwt.encode(to_encode, SECRET_KEY, algorithm=ALGORITHM)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jwt.py", line 63, in encode
    return jws.sign(claims, key, headers=headers, algorithm=algorithm)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jws.py", line 46, in sign
    encoded_payload = _encode_payload(payload)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jws.py", line 150, in _encode_payload
    payload = json.dumps(
              ^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
          ^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           ^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type UUID is not JSON serializable

INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 500 Internal Server Error"
____________________ ERROR at setup of test_create_product _____________________
venv/lib/python3.11/site-packages/pytest_asyncio/plugin.py:293: in _asyncgen_fixture_wrapper
    result = event_loop.run_until_complete(setup())
        event_loop = <_UnixSelectorEventLoop running=False closed=False debug=False>
        finalizer  = <function _wrap_asyncgen.<locals>._asyncgen_fixture_wrapper.<locals>.finalizer at 0x119886d40>
        func       = <function auth_client at 0x1175a44a0>
        gen_obj    = <async_generator object auth_client at 0x11724ec00>
        kwargs     = {'client': <httpx.AsyncClient object at 0x117648dd0>}
        request    = <SubRequest 'auth_client' for <Function test_create_product>>
        setup      = <function _wrap_asyncgen.<locals>._asyncgen_fixture_wrapper.<locals>.setup at 0x119887060>
/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py:654: in run_until_complete
    return future.result()
        future     = <Task finished name='Task-47' coro=<_wrap_asyncgen.<locals>._asyncgen_fixture_wrapper.<locals>.setup() done, defined at /Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/pytest_asyncio/plugin.py:274> exception=AssertionError('Login failed: {"detail":"An unexpected error occurred during login."}\nassert 500 == 200\n +  where 500 = <Response [500 Internal Server Error]>.status_code')>
        new_task   = True
        self       = <_UnixSelectorEventLoop running=False closed=False debug=False>
venv/lib/python3.11/site-packages/pytest_asyncio/plugin.py:275: in setup
    res = await gen_obj.__anext__()
        gen_obj    = <async_generator object auth_client at 0x11724ec00>
tests/conftest.py:239: in auth_client
    assert response.status_code == 200, f"Login failed: {response.text}"
E   AssertionError: Login failed: {"detail":"An unexpected error occurred during login."}
E   assert 500 == 200
E    +  where 500 = <Response [500 Internal Server Error]>.status_code
        client     = <httpx.AsyncClient object at 0x117648dd0>
        login_data = {'email': 'test@example.com', 'password': 'testpassword'}
        response   = <Response [500 Internal Server Error]>
------------------------------ Captured log setup ------------------------------
INFO     app.routers.auth:auth.py:603 Updated last_login_at for user afa53d60-96f9-47c3-8b40-1302612be145
ERROR    app.routers.auth:auth.py:628 Unexpected error during login for test@example.com: TypeError - Object of type UUID is not JSON serializable
ERROR    app.routers.auth:auth.py:630 Traceback (most recent call last):
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/app/routers/auth.py", line 617, in login_for_access_token
    access_token = create_access_token(data=token_data)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/app/security.py", line 82, in create_access_token
    encoded_jwt = jwt.encode(to_encode, SECRET_KEY, algorithm=ALGORITHM)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jwt.py", line 63, in encode
    return jws.sign(claims, key, headers=headers, algorithm=algorithm)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jws.py", line 46, in sign
    encoded_payload = _encode_payload(payload)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jws.py", line 150, in _encode_payload
    payload = json.dumps(
              ^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
          ^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           ^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type UUID is not JSON serializable

INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 500 Internal Server Error"
____________________ ERROR at setup of test_update_product _____________________
venv/lib/python3.11/site-packages/pytest_asyncio/plugin.py:293: in _asyncgen_fixture_wrapper
    result = event_loop.run_until_complete(setup())
        event_loop = <_UnixSelectorEventLoop running=False closed=False debug=False>
        finalizer  = <function _wrap_asyncgen.<locals>._asyncgen_fixture_wrapper.<locals>.finalizer at 0x119887920>
        func       = <function auth_client at 0x1175a44a0>
        gen_obj    = <async_generator object auth_client at 0x11724ee80>
        kwargs     = {'client': <httpx.AsyncClient object at 0x117648dd0>}
        request    = <SubRequest 'auth_client' for <Function test_update_product>>
        setup      = <function _wrap_asyncgen.<locals>._asyncgen_fixture_wrapper.<locals>.setup at 0x119887ba0>
/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py:654: in run_until_complete
    return future.result()
        future     = <Task finished name='Task-51' coro=<_wrap_asyncgen.<locals>._asyncgen_fixture_wrapper.<locals>.setup() done, defined at /Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/pytest_asyncio/plugin.py:274> exception=AssertionError('Login failed: {"detail":"An unexpected error occurred during login."}\nassert 500 == 200\n +  where 500 = <Response [500 Internal Server Error]>.status_code')>
        new_task   = True
        self       = <_UnixSelectorEventLoop running=False closed=False debug=False>
venv/lib/python3.11/site-packages/pytest_asyncio/plugin.py:275: in setup
    res = await gen_obj.__anext__()
        gen_obj    = <async_generator object auth_client at 0x11724ee80>
tests/conftest.py:239: in auth_client
    assert response.status_code == 200, f"Login failed: {response.text}"
E   AssertionError: Login failed: {"detail":"An unexpected error occurred during login."}
E   assert 500 == 200
E    +  where 500 = <Response [500 Internal Server Error]>.status_code
        client     = <httpx.AsyncClient object at 0x117648dd0>
        login_data = {'email': 'test@example.com', 'password': 'testpassword'}
        response   = <Response [500 Internal Server Error]>
------------------------------ Captured log setup ------------------------------
INFO     app.routers.auth:auth.py:603 Updated last_login_at for user afa53d60-96f9-47c3-8b40-1302612be145
ERROR    app.routers.auth:auth.py:628 Unexpected error during login for test@example.com: TypeError - Object of type UUID is not JSON serializable
ERROR    app.routers.auth:auth.py:630 Traceback (most recent call last):
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/app/routers/auth.py", line 617, in login_for_access_token
    access_token = create_access_token(data=token_data)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/app/security.py", line 82, in create_access_token
    encoded_jwt = jwt.encode(to_encode, SECRET_KEY, algorithm=ALGORITHM)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jwt.py", line 63, in encode
    return jws.sign(claims, key, headers=headers, algorithm=algorithm)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jws.py", line 46, in sign
    encoded_payload = _encode_payload(payload)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jws.py", line 150, in _encode_payload
    payload = json.dumps(
              ^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
          ^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           ^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type UUID is not JSON serializable

INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 500 Internal Server Error"
____________________ ERROR at setup of test_delete_product _____________________
venv/lib/python3.11/site-packages/pytest_asyncio/plugin.py:293: in _asyncgen_fixture_wrapper
    result = event_loop.run_until_complete(setup())
        event_loop = <_UnixSelectorEventLoop running=False closed=False debug=False>
        finalizer  = <function _wrap_asyncgen.<locals>._asyncgen_fixture_wrapper.<locals>.finalizer at 0x119887e20>
        func       = <function auth_client at 0x1175a44a0>
        gen_obj    = <async_generator object auth_client at 0x11724eac0>
        kwargs     = {'client': <httpx.AsyncClient object at 0x117648dd0>}
        request    = <SubRequest 'auth_client' for <Function test_delete_product>>
        setup      = <function _wrap_asyncgen.<locals>._asyncgen_fixture_wrapper.<locals>.setup at 0x119887a60>
/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py:654: in run_until_complete
    return future.result()
        future     = <Task finished name='Task-53' coro=<_wrap_asyncgen.<locals>._asyncgen_fixture_wrapper.<locals>.setup() done, defined at /Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/pytest_asyncio/plugin.py:274> exception=AssertionError('Login failed: {"detail":"An unexpected error occurred during login."}\nassert 500 == 200\n +  where 500 = <Response [500 Internal Server Error]>.status_code')>
        new_task   = True
        self       = <_UnixSelectorEventLoop running=False closed=False debug=False>
venv/lib/python3.11/site-packages/pytest_asyncio/plugin.py:275: in setup
    res = await gen_obj.__anext__()
        gen_obj    = <async_generator object auth_client at 0x11724eac0>
tests/conftest.py:239: in auth_client
    assert response.status_code == 200, f"Login failed: {response.text}"
E   AssertionError: Login failed: {"detail":"An unexpected error occurred during login."}
E   assert 500 == 200
E    +  where 500 = <Response [500 Internal Server Error]>.status_code
        client     = <httpx.AsyncClient object at 0x117648dd0>
        login_data = {'email': 'test@example.com', 'password': 'testpassword'}
        response   = <Response [500 Internal Server Error]>
------------------------------ Captured log setup ------------------------------
INFO     app.routers.auth:auth.py:603 Updated last_login_at for user afa53d60-96f9-47c3-8b40-1302612be145
ERROR    app.routers.auth:auth.py:628 Unexpected error during login for test@example.com: TypeError - Object of type UUID is not JSON serializable
ERROR    app.routers.auth:auth.py:630 Traceback (most recent call last):
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/app/routers/auth.py", line 617, in login_for_access_token
    access_token = create_access_token(data=token_data)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/app/security.py", line 82, in create_access_token
    encoded_jwt = jwt.encode(to_encode, SECRET_KEY, algorithm=ALGORITHM)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jwt.py", line 63, in encode
    return jws.sign(claims, key, headers=headers, algorithm=algorithm)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jws.py", line 46, in sign
    encoded_payload = _encode_payload(payload)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jws.py", line 150, in _encode_payload
    payload = json.dumps(
              ^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
          ^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           ^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type UUID is not JSON serializable

INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 500 Internal Server Error"
=================================== FAILURES ===================================
_____________________________ test_search_products _____________________________
tests/test_products.py:42: in test_search_products
    assert response.status_code == status.HTTP_200_OK
E   AttributeError: 'coroutine' object has no attribute 'status_code'
        client     = <httpx.AsyncClient object at 0x117648dd0>
        response   = <coroutine object AsyncClient.get at 0x1175cdd20>
        test_db    = <asyncpg.pool.Pool object at 0x1176028e0>
        verbose_db_conn = <PoolConnectionProxy <asyncpg.connection.Connection object at 0x117611fc0> 0x1198d8a30>
___________________________ test_get_product_detail ____________________________
tests/test_products.py:74: in test_get_product_detail
    assert response.status_code == status.HTTP_200_OK
E   AttributeError: 'coroutine' object has no attribute 'status_code'
        client     = <httpx.AsyncClient object at 0x117648dd0>
        conn       = <PoolConnectionProxy [released] 0x1198d9000>
        product_id = 1
        response   = <coroutine object AsyncClient.get at 0x1175cd7e0>
        test_db    = <asyncpg.pool.Pool object at 0x1176028e0>
______________ test_register_and_login_with_new_wallet_successful ______________
tests/test_auth.py:284: in test_register_and_login_with_new_wallet_successful
    assert response.status_code == status.HTTP_200_OK # Or 201 if registration part is emphasized, but 200 for login is fine
E   assert 422 == 200
E    +  where 422 = <Response [422 Unprocessable Entity]>.status_code
E    +  and   200 = status.HTTP_200_OK
        client     = <httpx.AsyncClient object at 0x1199de650>
        login_data = {'original_message': 'Sign this message to register and login',
 'signed_message': 'mock_valid_signature_for_new_wallet',
 'wallet_address': '0xf0e0a901812c4d19aa5de6e157da46d2'}
        mocker     = <pytest_mock.plugin.MockerFixture object at 0x1199dd6d0>
        original_message = 'Sign this message to register and login'
        response   = <Response [422 Unprocessable Entity]>
        signed_message = 'mock_valid_signature_for_new_wallet'
        verbose_db_conn = <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x1198fb490>
        wallet_address = '0xf0e0a901812c4d19aa5de6e157da46d2'
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login-wallet "HTTP/1.1 422 Unprocessable Entity"
___________________________ test_login_inactive_user ___________________________
tests/test_auth.py:220: in test_login_inactive_user
    assert response.status_code == status.HTTP_401_UNAUTHORIZED # As per current auth.py logic for inactive users
E   assert 403 == 401
E    +  where 403 = <Response [403 Forbidden]>.status_code
E    +  and   401 = status.HTTP_401_UNAUTHORIZED
        client     = <httpx.AsyncClient object at 0x1199de650>
        hashed_pw  = '$2b$12$V5S2RJTRkK3TBzpd2NDQ0ePgsT1fpfjjfleyZDLMJejveCUY3Uk66'
        login_data = {'email': 'inactive_user_deec63a3-e308-4057-9305-343fa8ec5378@example.com',
 'password': 'PasswordForInactive123!'}
        password   = 'PasswordForInactive123!'
        response   = <Response [403 Forbidden]>
        user_email = 'inactive_user_deec63a3-e308-4057-9305-343fa8ec5378@example.com'
        user_id    = '5b86ddc9-22dc-483d-8e5f-ace92c2b9290'
        verbose_db_conn = <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x1198d9300>
------------------------------ Captured log call -------------------------------
WARNING  app.routers.auth:auth.py:585 Login attempt failed: User inactive_user_deec63a3-e308-4057-9305-343fa8ec5378@example.com is inactive.
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 403 Forbidden"
____________________________ test_login_successful _____________________________
tests/test_auth.py:152: in test_login_successful
    assert response.status_code == status.HTTP_200_OK
E   assert 500 == 200
E    +  where 500 = <Response [500 Internal Server Error]>.status_code
E    +  and   200 = status.HTTP_200_OK
        client     = <httpx.AsyncClient object at 0x1199de650>
        hashed_pw  = '$2b$12$xzwhnwgUPFTeiOBghcf8WO9o5bGeur4VYNnERsX4KD.rxd9e8RLEW'
        login_data = {'email': 'login_success_5cb0a3f0-c531-4dea-bc9e-5d17549ad663@example.com',
 'password': 'StrongPassword123!'}
        password   = 'StrongPassword123!'
        response   = <Response [500 Internal Server Error]>
        user_email = 'login_success_5cb0a3f0-c531-4dea-bc9e-5d17549ad663@example.com'
        user_id    = '0683682c-4a8e-494d-befe-7a75828b71bc'
        verbose_db_conn = <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x1198db3a0>
------------------------------ Captured log call -------------------------------
INFO     app.routers.auth:auth.py:603 Updated last_login_at for user 0683682c-4a8e-494d-befe-7a75828b71bc
ERROR    app.routers.auth:auth.py:628 Unexpected error during login for login_success_5cb0a3f0-c531-4dea-bc9e-5d17549ad663@example.com: TypeError - Object of type UUID is not JSON serializable
ERROR    app.routers.auth:auth.py:630 Traceback (most recent call last):
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/app/routers/auth.py", line 617, in login_for_access_token
    access_token = create_access_token(data=token_data)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/app/security.py", line 82, in create_access_token
    encoded_jwt = jwt.encode(to_encode, SECRET_KEY, algorithm=ALGORITHM)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jwt.py", line 63, in encode
    return jws.sign(claims, key, headers=headers, algorithm=algorithm)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jws.py", line 46, in sign
    encoded_payload = _encode_payload(payload)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/boommac/Downloads/TAIC-Master/fastapi_ai_backend/venv/lib/python3.11/site-packages/jose/jws.py", line 150, in _encode_payload
    payload = json.dumps(
              ^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
          ^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           ^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type UUID is not JSON serializable

INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 500 Internal Server Error"
_______________ test_link_wallet_same_wallet_linked_not_verified _______________
tests/test_auth.py:680: in test_link_wallet_same_wallet_linked_not_verified
    assert response.status_code == status.HTTP_200_OK
E   assert 422 == 200
E    +  where 422 = <Response [422 Unprocessable Entity]>.status_code
E    +  and   200 = status.HTTP_200_OK
        client     = <httpx.AsyncClient object at 0x1199de650>
        headers    = {'Authorization': 'Bearer '
                  'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxYjljMjlmYS0zMzU4LTQ3ZjAtOWMzNi04NTA1ZTIyMDZhMjAiLCJleHAiOjE3NTAwMjQ5OTksImlhdCI6MTc1MDAyMzE5OX0.BMOs2fmu8lP-6KH7O6DMg6SPzqCm0hdHXuSeuzYvdQU'}
        link_data  = {'original_message': 'msg',
 'signed_message': 'sig',
 'wallet_address': '0x717882374e424167adc05e93b3c1ad79'}
        mocker     = <pytest_mock.plugin.MockerFixture object at 0x117662dd0>
        response   = <Response [422 Unprocessable Entity]>
        token      = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxYjljMjlmYS0zMzU4LTQ3ZjAtOWMzNi04NTA1ZTIyMDZhMjAiLCJleHAiOjE3NTAwMjQ5OTksImlhdCI6MTc1MDAyMzE5OX0.BMOs2fmu8lP-6KH7O6DMg6SPzqCm0hdHXuSeuzYvdQU'
        user_id    = '1b9c29fa-3358-47f0-9c36-8505e2206a20'
        verbose_db_conn = <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x119bfb340>
        wallet_address = '0x717882374e424167adc05e93b3c1ad79'
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/link-wallet "HTTP/1.1 422 Unprocessable Entity"
_____________________ test_login_wallet_invalid_signature ______________________
tests/test_auth.py:315: in test_login_wallet_invalid_signature
    assert response.status_code == status.HTTP_401_UNAUTHORIZED
E   assert 422 == 401
E    +  where 422 = <Response [422 Unprocessable Entity]>.status_code
E    +  and   401 = status.HTTP_401_UNAUTHORIZED
        client     = <httpx.AsyncClient object at 0x1199de650>
        login_data = {'original_message': 'Some message',
 'signed_message': 'mock_invalid_signature',
 'wallet_address': '0x10b192daa50b440caa290842fdaefd63'}
        mocker     = <pytest_mock.plugin.MockerFixture object at 0x119805a90>
        original_message = 'Some message'
        response   = <Response [422 Unprocessable Entity]>
        signed_message = 'mock_invalid_signature'
        wallet_address = '0x10b192daa50b440caa290842fdaefd63'
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login-wallet "HTTP/1.1 422 Unprocessable Entity"
______ test_register_user_invalid_input[invalid_payload3-Field required] _______
tests/test_auth.py:126: in test_register_user_invalid_input
    assert response.status_code == status.HTTP_422_UNPROCESSABLE_ENTITY
E   assert 201 == 422
E    +  where 201 = <Response [201 Created]>.status_code
E    +  and   422 = status.HTTP_422_UNPROCESSABLE_ENTITY
        client     = <httpx.AsyncClient object at 0x1199de650>
        expected_detail_contains = 'Field required'
        invalid_payload = {'email': 'missing_role_37168127-d6a0-4e95-9cc0-d32f3f3f2ddb@example.com',
 'password': 'Pass123!'}
        response   = <Response [201 Created]>
------------------------------ Captured log call -------------------------------
INFO     app.routers.auth:auth.py:88 User 'missing_role_37168127-d6a0-4e95-9cc0-d32f3f3f2ddb@example.com' (ID: 15c021b5-efc5-4b37-bf1b-16c56a17a608) registered successfully as 'SHOPPER'.
WARNING  app.email_utils:email_utils.py:164 Resend API key not configured. Skipping actual email send to missing_role_37168127-d6a0-4e95-9cc0-d32f3f3f2ddb@example.com with subject: Welcome to TAIC! Your Adventure Awaits!
INFO     app.email_utils:email_utils.py:165 --- EMAIL CONTENT (SIMULATED SEND) ---
INFO     app.email_utils:email_utils.py:166 To: missing_role_37168127-d6a0-4e95-9cc0-d32f3f3f2ddb@example.com
INFO     app.email_utils:email_utils.py:167 Subject: Welcome to TAIC! Your Adventure Awaits!
INFO     app.email_utils:email_utils.py:168 Body (Text): 
Hello missing_role_37168127-d6a0-4e95-9cc0-d32f3f3f2ddb@example.com,

Welcome to TAIC - The AI-Powered Crypto Commerce Marketplace!

We're thrilled to have you join our community. Get ready to explore a new era of online shopping where innovation meets convenience.

Here's what you can do on TAIC:
...
INFO     app.email_utils:email_utils.py:169 Body (HTML): 
<!DOCTYPE html>
<html>
<head>
    <title>Welcome to TAIC!</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 20px; color: #333; }
        .container { background-color: #f9f9f9; padding: 20px; border-radius: 8px; }
        .header { font-size: 24px; font-weight: ...
INFO     app.email_utils:email_utils.py:170 --- END SIMULATED EMAIL SEND ---
WARNING  app.routers.auth:auth.py:113 Welcome email simulation reported failure for missing_role_37168127-d6a0-4e95-9cc0-d32f3f3f2ddb@example.com (role: SHOPPER).
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/register "HTTP/1.1 201 Created"
______________________ test_link_wallet_invalid_signature ______________________
tests/test_auth.py:613: in test_link_wallet_invalid_signature
    assert response.status_code == status.HTTP_400_BAD_REQUEST # As per auth.py logic
E   assert 422 == 400
E    +  where 422 = <Response [422 Unprocessable Entity]>.status_code
E    +  and   400 = status.HTTP_400_BAD_REQUEST
        client     = <httpx.AsyncClient object at 0x1199de650>
        headers    = {'Authorization': 'Bearer '
                  'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIwZTYxZmQyMC0xZDFlLTRkM2UtYTk0OS1jODNiZjA1MzRiYzgiLCJleHAiOjE3NTAwMjUwMDAsImlhdCI6MTc1MDAyMzIwMH0.M8oo58BGsVF-OKV9hGSIq7HABaLeE0y3PwzLiZtOspA'}
        link_data  = {'original_message': 'msg',
 'signed_message': 'invalid_sig',
 'wallet_address': '0xbf70d66e0d394a0f86104a97387c735d'}
        mocker     = <pytest_mock.plugin.MockerFixture object at 0x11983b6d0>
        response   = <Response [422 Unprocessable Entity]>
        token      = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIwZTYxZmQyMC0xZDFlLTRkM2UtYTk0OS1jODNiZjA1MzRiYzgiLCJleHAiOjE3NTAwMjUwMDAsImlhdCI6MTc1MDAyMzIwMH0.M8oo58BGsVF-OKV9hGSIq7HABaLeE0y3PwzLiZtOspA'
        user_id    = '0e61fd20-1d1e-4d3e-a949-c83bf0534bc8'
        verbose_db_conn = <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x117640970>
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/link-wallet "HTTP/1.1 422 Unprocessable Entity"
_________________________ test_link_wallet_successful __________________________
tests/test_auth.py:513: in test_link_wallet_successful
    assert response.status_code == status.HTTP_200_OK
E   assert 422 == 200
E    +  where 422 = <Response [422 Unprocessable Entity]>.status_code
E    +  and   200 = status.HTTP_200_OK
        access_token = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIzZjQ4MGJhNy1mMjRhLTQ2NDQtOGRiNy01MmYxM2U4MDlmZDkiLCJleHAiOjE3NTAwMjUwMDEsImlhdCI6MTc1MDAyMzIwMX0.jU2fGch5144Qjgh6GHNtUrQeh1HAt9gjz2-91rdOCmU'
        client     = <httpx.AsyncClient object at 0x1199de650>
        headers    = {'Authorization': 'Bearer '
                  'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIzZjQ4MGJhNy1mMjRhLTQ2NDQtOGRiNy01MmYxM2U4MDlmZDkiLCJleHAiOjE3NTAwMjUwMDEsImlhdCI6MTc1MDAyMzIwMX0.jU2fGch5144Qjgh6GHNtUrQeh1HAt9gjz2-91rdOCmU'}
        link_data  = {'original_message': 'Sign to link this wallet',
 'signed_message': 'mock_signature_for_link',
 'wallet_address': '0x51f40f7144ea4b8a97fe239e3e1f27a8'}
        mocker     = <pytest_mock.plugin.MockerFixture object at 0x119b4c350>
        new_wallet_address = '0x51f40f7144ea4b8a97fe239e3e1f27a8'
        original_message = 'Sign to link this wallet'
        response   = <Response [422 Unprocessable Entity]>
        signed_message = 'mock_signature_for_link'
        user_email = 'link_wallet_user_e1ced591-f272-4ff5-abd1-7d10ecbc35c4@example.com'
        user_id    = '3f480ba7-f24a-4644-8db7-52f13e809fd9'
        verbose_db_conn = <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x119998910>
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/link-wallet "HTTP/1.1 422 Unprocessable Entity"
_______________________ test_login_wallet_inactive_user ________________________
tests/test_auth.py:343: in test_login_wallet_inactive_user
    assert response.status_code == status.HTTP_403_FORBIDDEN # As per auth.py logic for inactive wallet user
E   assert 422 == 403
E    +  where 422 = <Response [422 Unprocessable Entity]>.status_code
E    +  and   403 = status.HTTP_403_FORBIDDEN
        client     = <httpx.AsyncClient object at 0x1199de650>
        login_data = {'original_message': 'Sign this message',
 'signed_message': 'mock_signature_for_inactive',
 'wallet_address': '0x055a4f8e32ad401987a63c6918c8d1fa'}
        mocker     = <pytest_mock.plugin.MockerFixture object at 0x119b99f10>
        original_message = 'Sign this message'
        response   = <Response [422 Unprocessable Entity]>
        signed_message = 'mock_signature_for_inactive'
        user_id    = '5abc50ac-8186-4699-b3f1-c474646579e2'
        verbose_db_conn = <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x117677fa0>
        wallet_address = '0x055a4f8e32ad401987a63c6918c8d1fa'
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login-wallet "HTTP/1.1 422 Unprocessable Entity"
___________ test_link_wallet_same_wallet_already_linked_and_verified ___________
tests/test_auth.py:651: in test_link_wallet_same_wallet_already_linked_and_verified
    assert response.status_code == status.HTTP_200_OK
E   assert 422 == 200
E    +  where 422 = <Response [422 Unprocessable Entity]>.status_code
E    +  and   200 = status.HTTP_200_OK
        client     = <httpx.AsyncClient object at 0x1199de650>
        headers    = {'Authorization': 'Bearer '
                  'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJlMjE1YmQ3Ny05MjNiLTQwZDAtYmY5MC1kYWU5YzQ4Yjk3OWUiLCJleHAiOjE3NTAwMjUwMDMsImlhdCI6MTc1MDAyMzIwM30.icMcncvl-0q2uUQD5l-j5PP2m5SspAtvh--dTjCifBk'}
        link_data  = {'original_message': 'msg',
 'signed_message': 'sig',
 'wallet_address': '0x995b3f825e7d4ef7a3bee01e5bf5d357'}
        mocker     = <pytest_mock.plugin.MockerFixture object at 0x119b25490>
        response   = <Response [422 Unprocessable Entity]>
        token      = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJlMjE1YmQ3Ny05MjNiLTQwZDAtYmY5MC1kYWU5YzQ4Yjk3OWUiLCJleHAiOjE3NTAwMjUwMDMsImlhdCI6MTc1MDAyMzIwM30.icMcncvl-0q2uUQD5l-j5PP2m5SspAtvh--dTjCifBk'
        user_id    = 'e215bd77-923b-40d0-bf90-dae9c48b979e'
        verbose_db_conn = <PoolConnectionProxy <asyncpg.connection.Connection object at 0x119b6b220> 0x117675600>
        wallet_address = '0x995b3f825e7d4ef7a3bee01e5bf5d357'
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/link-wallet "HTTP/1.1 422 Unprocessable Entity"
============================= slowest 10 durations =============================
1.22s setup    tests/test_product_variants.py::test_update_product_variant
0.80s setup    tests/test_auth.py::test_register_user_email_already_exists
0.80s call     tests/test_auth.py::test_link_wallet_same_wallet_already_linked_and_verified
0.73s call     tests/test_auth.py::test_login_successful
0.67s call     tests/test_auth.py::test_link_email_password_successful
0.59s call     tests/test_auth.py::test_read_users_me_success
0.57s setup    tests/test_product_variants.py::test_create_product_variant
0.54s call     tests/test_auth.py::test_link_email_password_account_already_has_email
0.51s call     tests/test_auth.py::test_link_wallet_same_wallet_linked_not_verified
0.50s call     tests/test_auth.py::test_link_email_password_new_email_already_used_by_other
=========================== short test summary info ============================
FAILED tests/test_products.py::test_search_products - AttributeError: 'corout...
FAILED tests/test_products.py::test_get_product_detail - AttributeError: 'cor...
FAILED tests/test_auth.py::test_register_and_login_with_new_wallet_successful
FAILED tests/test_auth.py::test_login_inactive_user - assert 403 == 401
FAILED tests/test_auth.py::test_login_successful - assert 500 == 200
FAILED tests/test_auth.py::test_link_wallet_same_wallet_linked_not_verified
FAILED tests/test_auth.py::test_login_wallet_invalid_signature - assert 422 =...
FAILED tests/test_auth.py::test_register_user_invalid_input[invalid_payload3-Field required]
FAILED tests/test_auth.py::test_link_wallet_invalid_signature - assert 422 ==...
FAILED tests/test_auth.py::test_link_wallet_successful - assert 422 == 200
FAILED tests/test_auth.py::test_login_wallet_inactive_user - assert 422 == 403
FAILED tests/test_auth.py::test_link_wallet_same_wallet_already_linked_and_verified
ERROR tests/test_product_variants.py::test_update_product_variant - Assertion...
ERROR tests/test_product_variants.py::test_delete_product_variant - Assertion...
ERROR tests/test_product_variants.py::test_create_product_variant - Assertion...
ERROR tests/test_products.py::test_create_product - AssertionError: Login fai...
ERROR tests/test_products.py::test_update_product - AssertionError: Login fai...
ERROR tests/test_products.py::test_delete_product - AssertionError: Login fai...
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! KeyboardInterrupt !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
/usr/local/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/selectors.py:566: KeyboardInterrupt
(to show a full traceback on KeyboardInterrupt use --full-trace)
=================== 12 failed, 14 passed, 6 errors in 46.67s ===================
